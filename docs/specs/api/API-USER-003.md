# API-USER-003: ユーザー新規作成

> **ドキュメント種別**: 最新仕様（継続的にメンテナンス）

## 1. 基本情報

| 項目 | 内容 |
|------|------|
| API ID | API-USER-003 |
| メソッド | POST |
| パス | /api/users |
| 機能 | 新しいユーザーを作成 |
| 認証 | 不要 |

---

## 2. 利用案件

| 案件 | 日付 | 変更内容 |
|------|------|----------|
| 20251204_担当者機能追加 | 2025-12-04 | 新規作成 |

---

## 3. 参照システム

### 3.1 画面

| 画面ID | 画面名 | 利用イベント | 用途 |
|--------|--------|-------------|------|
| - | - | - | 現在画面からの直接利用なし（管理機能未実装） |

### 3.2 外部システム

| システム | 用途 |
|---------|------|
| - | 現在なし |

**注意**: このAPIは現在、直接APIを叩くか、テストデータ作成時に使用される。

---

## 4. リクエスト

### 4.1 パスパラメータ

なし

### 4.2 クエリパラメータ

なし

### 4.3 リクエストボディ

```json
{
  "name": "新規ユーザー"
}
```

| フィールド | 型 | 必須 | 制約 | 説明 |
|-----------|-----|------|------|------|
| name | String | 必須 | 1〜100文字、一意 | ユーザー名 |

---

## 5. レスポンス

### 5.1 ステータスコード

| コード | 条件 |
|--------|------|
| 201 | 作成成功 |
| 400 | バリデーションエラー（名前未入力、100文字超過） |
| 409 | 名前が重複（Conflict） |

### 5.2 レスポンスボディ（成功時）

```json
{
  "id": 1,
  "name": "新規ユーザー",
  "createdAt": "2025-12-22T10:00:00"
}
```

---

## 6. 処理フロー

```
1. リクエスト受信（リクエストボディ取得）
   │
2. バリデーション
   │  ├─ name が空または未指定 → 400エラー
   │  └─ name が100文字超過 → 400エラー
   │
3. 重複チェック
   │  └─ UserMapper.findByName(name) が存在 → 409エラー
   │
4. Userエンティティ生成
   │  └─ createdAt = 現在日時
   │
5. UserMapper.insert(user) 呼び出し
   │
6. レスポンス返却（201 + 作成されたUser）
```

---

## 7. エラー処理

| ケース | HTTPステータス | エラーメッセージ |
|--------|---------------|-----------------|
| name が空または未指定 | 400 | Name is required |
| name が100文字超過 | 400 | Name must be 100 characters or less |
| name が既存ユーザーと重複 | 409 | User name already exists |

---

## 8. 関連項目

| 種別 | ID | 名称 |
|------|-----|------|
| API | [API-USER-001](API-USER-001.md) | ユーザー全件取得 |
| ロジック | UserService.create | 作成ロジック |
| Mapper | UserMapper.insert | DB挿入 |
| Mapper | UserMapper.findByName | 重複チェック |

---

## 更新履歴

| 日付 | 変更内容 | 関連案件 |
|------|----------|----------|
| 2025-12-23 | 初版作成 | - |
