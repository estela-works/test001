# API一覧

> **ドキュメント種別**: 最新仕様（継続的にメンテナンス）

## 1. 概要

| 項目 | 内容 |
|------|------|
| ベースURL | `/api` |
| 形式 | REST API |
| コンテンツタイプ | application/json |
| 最終更新日 | 2025-12-22 |

---

## 2. エンドポイント一覧

| メソッド | パス | 機能 | レスポンス | 追加案件 |
|---------|------|------|-----------|----------|
| GET | /api/todos | 全件取得 | 200 + List | 初期構築 |
| GET | /api/todos?completed={bool} | フィルタ取得 | 200 + List | 初期構築 |
| GET | /api/todos/{id} | 単一取得 | 200 or 404 | 初期構築 |
| GET | /api/todos/stats | 統計取得 | 200 + Map | 初期構築 |
| POST | /api/todos | 新規作成 | 201 + Todo | 初期構築 |
| PUT | /api/todos/{id} | 更新 | 200 or 404 | 初期構築 |
| PATCH | /api/todos/{id}/toggle | 完了切替 | 200 or 404 | 初期構築 |
| DELETE | /api/todos/{id} | 単一削除 | 204 or 404 | 初期構築 |
| DELETE | /api/todos | 全件削除 | 204 | 初期構築 |
| GET | /api/users | ユーザー全件取得 | 200 + List | 202512_担当者機能追加 |
| GET | /api/users/{id} | ユーザー単一取得 | 200 or 404 | 202512_担当者機能追加 |
| POST | /api/users | ユーザー新規作成 | 201 or 400 or 409 | 202512_担当者機能追加 |
| DELETE | /api/users/{id} | ユーザー削除 | 204 or 404 | 202512_担当者機能追加 |

---

## 3. API詳細

### 3.1 GET /api/todos - 全件取得

**概要**: 全ToDoを作成日時順で取得

**クエリパラメータ**:

| パラメータ | 型 | 必須 | 説明 |
|-----------|-----|------|------|
| completed | boolean | 任意 | true=完了のみ, false=未完了のみ |

**レスポンス**:

```json
[
  {
    "id": 1,
    "title": "タスク名",
    "description": "説明",
    "completed": false,
    "createdAt": "2025-12-22T10:00:00",
    "assigneeId": 1,
    "assigneeName": "山田太郎"
  }
]
```

---

### 3.2 GET /api/todos/{id} - 単一取得

**概要**: ID指定でToDoを取得

**パスパラメータ**:

| パラメータ | 型 | 説明 |
|-----------|-----|------|
| id | Long | ToDoのID |

**レスポンス**:

| ステータス | 条件 |
|-----------|------|
| 200 | 成功 |
| 404 | 指定IDが存在しない |

---

### 3.3 GET /api/todos/stats - 統計取得

**概要**: ToDoの統計情報を取得

**レスポンス**:

```json
{
  "total": 3,
  "completed": 1,
  "pending": 2
}
```

---

### 3.4 POST /api/todos - 新規作成

**概要**: 新しいToDoを作成

**リクエストボディ**:

```json
{
  "title": "タスク名",
  "description": "説明",
  "assigneeId": 1
}
```

| フィールド | 型 | 必須 | 説明 |
|-----------|-----|------|------|
| title | string | 必須 | タイトル |
| description | string | 任意 | 説明 |
| assigneeId | Long | 任意 | 担当者ID |

**レスポンス**:

| ステータス | 条件 |
|-----------|------|
| 201 | 作成成功 |
| 400 | タイトル未入力、または担当者IDが存在しない |

---

### 3.5 PUT /api/todos/{id} - 更新

**概要**: 既存のToDoを更新

**パスパラメータ**:

| パラメータ | 型 | 説明 |
|-----------|-----|------|
| id | Long | ToDoのID |

**リクエストボディ**:

```json
{
  "title": "更新後タイトル",
  "description": "更新後説明",
  "completed": true,
  "assigneeId": 2
}
```

**レスポンス**:

| ステータス | 条件 |
|-----------|------|
| 200 | 更新成功 |
| 400 | 担当者IDが存在しない |
| 404 | 指定IDが存在しない |

---

### 3.6 PATCH /api/todos/{id}/toggle - 完了切替

**概要**: 完了状態を反転

**パスパラメータ**:

| パラメータ | 型 | 説明 |
|-----------|-----|------|
| id | Long | ToDoのID |

**レスポンス**:

| ステータス | 条件 |
|-----------|------|
| 200 | 切替成功 |
| 404 | 指定IDが存在しない |

---

### 3.7 DELETE /api/todos/{id} - 単一削除

**概要**: 指定ToDoを削除

**パスパラメータ**:

| パラメータ | 型 | 説明 |
|-----------|-----|------|
| id | Long | ToDoのID |

**レスポンス**:

| ステータス | 条件 |
|-----------|------|
| 204 | 削除成功 |
| 404 | 指定IDが存在しない |

---

### 3.8 DELETE /api/todos - 全件削除

**概要**: 全ToDoを削除

**レスポンス**:

| ステータス | 条件 |
|-----------|------|
| 204 | 削除成功 |

---

## 4. 共通レスポンス形式

### 4.1 Todoオブジェクト

```json
{
  "id": 1,
  "title": "タスク名",
  "description": "説明",
  "completed": false,
  "createdAt": "2025-12-22T10:00:00",
  "assigneeId": 1,
  "assigneeName": "山田太郎"
}
```

| フィールド | 型 | 説明 |
|-----------|-----|------|
| id | Long | 一意識別子 |
| title | String | タイトル |
| description | String | 説明 |
| completed | boolean | 完了フラグ |
| createdAt | LocalDateTime | 作成日時 |
| assigneeId | Long | 担当者ID（nullable） |
| assigneeName | String | 担当者名（nullable、表示用） |

### 4.2 Userオブジェクト

```json
{
  "id": 1,
  "name": "山田太郎",
  "createdAt": "2025-12-22T10:00:00"
}
```

| フィールド | 型 | 説明 |
|-----------|-----|------|
| id | Long | 一意識別子 |
| name | String | ユーザー名 |
| createdAt | LocalDateTime | 作成日時 |

### 4.3 エラーレスポンス

| ステータス | 条件 |
|-----------|------|
| 400 Bad Request | バリデーションエラー |
| 404 Not Found | リソース未発見 |
| 409 Conflict | 重複エラー（ユーザー名重複など） |

---

## 5. User API詳細

### 5.1 GET /api/users - ユーザー全件取得

**概要**: 全ユーザーを作成日時順で取得

**レスポンス**:

```json
[
  {
    "id": 1,
    "name": "山田太郎",
    "createdAt": "2025-12-22T10:00:00"
  }
]
```

| ステータス | 条件 |
|-----------|------|
| 200 | 成功 |

---

### 5.2 GET /api/users/{id} - ユーザー単一取得

**概要**: ID指定でユーザーを取得

**パスパラメータ**:

| パラメータ | 型 | 説明 |
|-----------|-----|------|
| id | Long | ユーザーID |

**レスポンス**:

| ステータス | 条件 |
|-----------|------|
| 200 | 成功 |
| 404 | 指定IDが存在しない |

---

### 5.3 POST /api/users - ユーザー新規作成

**概要**: 新しいユーザーを作成

**リクエストボディ**:

```json
{
  "name": "新規ユーザー"
}
```

| フィールド | 型 | 必須 | 制約 | 説明 |
|-----------|-----|------|------|------|
| name | string | 必須 | 1〜100文字、一意 | ユーザー名 |

**レスポンス**:

| ステータス | 条件 |
|-----------|------|
| 201 | 作成成功 |
| 400 | 名前未入力、または100文字超過 |
| 409 | 名前が重複 |

---

### 5.4 DELETE /api/users/{id} - ユーザー削除

**概要**: 指定ユーザーを削除（関連ToDoの担当者はNULLに設定）

**パスパラメータ**:

| パラメータ | 型 | 説明 |
|-----------|-----|------|
| id | Long | ユーザーID |

**レスポンス**:

| ステータス | 条件 |
|-----------|------|
| 204 | 削除成功 |
| 404 | 指定IDが存在しない |

**補足**: ユーザー削除時、そのユーザーが担当者として設定されているToDoのassigneeIdはNULLに設定される。

---

## 更新履歴

| 日付 | 変更内容 | 関連案件 |
|------|----------|----------|
| 2025-12-22 | 初版作成（9エンドポイント） | 初期構築 |
| 2025-12-22 | User API追加（4エンドポイント）、Todoにassignee追加 | 202512_担当者機能追加 |
