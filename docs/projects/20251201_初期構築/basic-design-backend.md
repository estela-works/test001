# バックエンド基本設計書

## 案件情報

| 項目 | 内容 |
|------|------|
| 案件名 | ToDoアプリケーション初期構築 |
| 案件ID | 202512_初期構築 |
| 作成日 | 2025-12-22 |
| 関連要件整理書 | [requirements.md](./requirements.md) |

---

## 1. 概要

### 1.1 本設計書の目的

バックエンドが担う機能・データ・APIの基本設計を定義する。

### 1.2 バックエンドの役割

| 責務 | 説明 |
|------|------|
| データ管理 | ToDoデータの保持と整合性維持 |
| ビジネスロジック | CRUD操作、状態管理、統計計算 |
| API提供 | フロントエンドへのREST API提供 |
| バリデーション | 入力データの妥当性検証 |

---

## 2. 機能要件

### 2.1 機能一覧

| ID | 機能名 | 概要 | 対応US |
|----|--------|------|--------|
| F-001 | ToDo作成 | タイトル・説明を入力してToDoを新規登録 | US-001 |
| F-002 | ToDo一覧取得 | 全ToDoを作成日時順で取得 | US-002 |
| F-003 | ToDo単一取得 | ID指定でToDoを取得 | US-002 |
| F-004 | ToDo更新 | 既存ToDoの内容を更新 | - |
| F-005 | 完了状態切替 | 完了/未完了をトグル | US-003 |
| F-006 | ToDo削除 | 指定ToDoを削除 | US-004 |
| F-007 | ToDo全削除 | 全ToDoを削除 | US-004 |
| F-008 | フィルタ取得 | 完了状態で絞り込み | US-005 |
| F-009 | 統計情報取得 | 総数/完了数/未完了数を取得 | US-006 |

---

## 3. データ要件

### 3.1 データ構造

| データ名 | 概要 | 永続化 |
|---------|------|--------|
| Todo | ToDoアイテムのデータ | 不要（インメモリ） |

### 3.2 Todoエンティティ

| 属性 | 型 | 必須 | 説明 |
|------|-----|------|------|
| id | Long | 自動 | 一意識別子（自動採番） |
| title | String | 必須 | タイトル |
| description | String | 任意 | 説明 |
| completed | boolean | 自動 | 完了フラグ（初期値: false） |
| createdAt | LocalDateTime | 自動 | 作成日時（自動設定） |

---

## 4. API要件

### 4.1 エンドポイント一覧

| メソッド | パス | 機能 | 対応機能 |
|---------|------|------|----------|
| GET | /api/todos | 全件取得 | F-002 |
| GET | /api/todos?completed={bool} | フィルタ取得 | F-008 |
| GET | /api/todos/{id} | 単一取得 | F-003 |
| GET | /api/todos/stats | 統計取得 | F-009 |
| POST | /api/todos | 新規作成 | F-001 |
| PUT | /api/todos/{id} | 更新 | F-004 |
| PATCH | /api/todos/{id}/toggle | 完了切替 | F-005 |
| DELETE | /api/todos/{id} | 単一削除 | F-006 |
| DELETE | /api/todos | 全件削除 | F-007 |

### 4.2 レスポンス形式

**Todoオブジェクト**:
```json
{
  "id": 1,
  "title": "タスク名",
  "description": "説明",
  "completed": false,
  "createdAt": "2025-12-22T10:00:00"
}
```

**統計情報**:
```json
{
  "total": 3,
  "completed": 1,
  "pending": 2
}
```

### 4.3 エラーレスポンス

| ステータス | 条件 |
|-----------|------|
| 400 Bad Request | タイトル未入力 |
| 404 Not Found | 指定IDが存在しない |

---

## 5. 非機能要件

### 5.1 性能要件

| 項目 | 要件 |
|------|------|
| API応答時間 | 1秒以内 |
| 同時アクセス | 複数リクエストの安全な処理 |

### 5.2 セキュリティ要件

| 項目 | 対応 |
|------|------|
| 認証 | なし（単一ユーザー想定） |
| 入力バリデーション | タイトル必須チェック |

---

## 6. 制約条件

| 項目 | 制約 |
|------|------|
| データ保存 | インメモリ（アプリ再起動でリセット） |
| スレッドセーフティ | ConcurrentHashMap使用 |

---

## 改版履歴

| 版数 | 日付 | 変更内容 | 変更者 |
|------|------|----------|--------|
| 1.0 | 2025-12-22 | 初版作成（既存基本設計書から分離） | - |
