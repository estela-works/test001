# テスト仕様書

## 案件情報

| 項目 | 内容 |
|------|------|
| 案件名 | ToDoアプリケーション初期構築 |
| 案件ID | 202512_初期構築 |
| 作成日 | 2025-12-22 |
| 関連詳細設計書 | [detail-design.md](./detail-design.md) |

---

## 1. テスト概要

### 1.1 テスト対象

| 対象 | 変更種別 | 概要 |
|------|----------|------|
| TodoService | 新規 | ToDoアイテムのCRUD操作とビジネスロジック |

### 1.2 テスト方針

- 各メソッドに対して正常系・異常系・境界値のテストケースを定義
- JUnit 5 + AssertJ でテストを実装
- `@BeforeEach` で新しいTodoServiceインスタンスを生成し、状態をリセット
- `@Nested` でメソッドごとにテストをグループ化

---

## 2. 単体テスト

### 2.1 TodoServiceTest

**テスト対象**: `com.example.demo.TodoService`

---

### getAllTodos() - 全ToDo取得

#### TC-GT-001: 初期状態で取得

| 項目 | 内容 |
|------|------|
| テストケースID | TC-GT-001 |
| テスト観点 | 初期状態でサンプルデータが取得できること |
| 分類 | 正常系 |
| 前提条件 | サンプルデータ3件が存在 |
| 入力値 | なし |
| 期待結果 | 3件が作成日時順で返却される |

#### TC-GT-002: 全削除後に取得

| 項目 | 内容 |
|------|------|
| テストケースID | TC-GT-002 |
| テスト観点 | 全削除後は空リストが返却されること |
| 分類 | 境界値 |
| 前提条件 | 全ToDoを削除済み |
| 入力値 | なし |
| 期待結果 | 空のリストが返却される |

#### TC-GT-003: 新規追加後に取得

| 項目 | 内容 |
|------|------|
| テストケースID | TC-GT-003 |
| テスト観点 | 追加したToDoが含まれて返却されること |
| 分類 | 正常系 |
| 前提条件 | サンプル3件 + 新規1件 |
| 入力値 | なし |
| 期待結果 | 4件が作成日時順で返却される |

---

### getTodosByCompleted(boolean completed) - フィルタリング

#### TC-GC-001: completed=falseでフィルタ

| 項目 | 内容 |
|------|------|
| テストケースID | TC-GC-001 |
| テスト観点 | 未完了のToDoのみ取得できること |
| 分類 | 正常系 |
| 前提条件 | 1件を完了状態に変更 |
| 入力値 | completed=false |
| 期待結果 | 未完了のToDoのみ返却（2件） |

#### TC-GC-002: completed=trueでフィルタ

| 項目 | 内容 |
|------|------|
| テストケースID | TC-GC-002 |
| テスト観点 | 完了済みのToDoのみ取得できること |
| 分類 | 正常系 |
| 前提条件 | 2件を完了状態に変更 |
| 入力値 | completed=true |
| 期待結果 | 完了済みのToDoのみ返却（2件） |

#### TC-GC-003: 該当なしの場合

| 項目 | 内容 |
|------|------|
| テストケースID | TC-GC-003 |
| テスト観点 | 該当がない場合は空リストが返却されること |
| 分類 | 境界値 |
| 前提条件 | 全て未完了 |
| 入力値 | completed=true |
| 期待結果 | 空のリストが返却される |

---

### getTodoById(Long id) - ID指定で取得

#### TC-GI-001: 存在するIDで取得

| 項目 | 内容 |
|------|------|
| テストケースID | TC-GI-001 |
| テスト観点 | 存在するIDでToDoが取得できること |
| 分類 | 正常系 |
| 前提条件 | ID=1が存在 |
| 入力値 | id=1 |
| 期待結果 | 該当のTodoが返却される |

#### TC-GI-002: 存在しないIDで取得

| 項目 | 内容 |
|------|------|
| テストケースID | TC-GI-002 |
| テスト観点 | 存在しないIDでnullが返却されること |
| 分類 | 異常系 |
| 前提条件 | ID=999は存在しない |
| 入力値 | id=999 |
| 期待結果 | nullが返却される |

---

### createTodo(Todo todo) - 新規作成

#### TC-CT-001: 正常なToDoを作成

| 項目 | 内容 |
|------|------|
| テストケースID | TC-CT-001 |
| テスト観点 | ToDoが正常に作成されIDが付与されること |
| 分類 | 正常系 |
| 前提条件 | title, descriptionを設定 |
| 入力値 | title="新規タスク", description="説明" |
| 期待結果 | IDが自動採番（4）され、作成されたTodoが返却される |

#### TC-CT-002: 連続作成時のID採番

| 項目 | 内容 |
|------|------|
| テストケースID | TC-CT-002 |
| テスト観点 | 連続作成でIDが連番になること |
| 分類 | 正常系 |
| 前提条件 | 3件連続で作成 |
| 入力値 | 3件のTodo |
| 期待結果 | IDが連番で採番される（4, 5, 6） |

---

### updateTodo(Long id, Todo updatedTodo) - 更新

#### TC-UT-001: 存在するToDoを更新

| 項目 | 内容 |
|------|------|
| テストケースID | TC-UT-001 |
| テスト観点 | 更新内容が正しく反映されること |
| 分類 | 正常系 |
| 前提条件 | ID=1が存在 |
| 入力値 | id=1, 更新内容 |
| 期待結果 | 更新されたTodoが返却、内容が反映されている |

#### TC-UT-002: 存在しないIDで更新

| 項目 | 内容 |
|------|------|
| テストケースID | TC-UT-002 |
| テスト観点 | 存在しないIDでnullが返却されること |
| 分類 | 異常系 |
| 前提条件 | ID=999は存在しない |
| 入力値 | id=999 |
| 期待結果 | nullが返却される |

#### TC-UT-003: createdAtが変更されないこと

| 項目 | 内容 |
|------|------|
| テストケースID | TC-UT-003 |
| テスト観点 | 更新時にcreatedAtは維持されること |
| 分類 | 境界値 |
| 前提条件 | ID=1が存在 |
| 入力値 | id=1, 更新内容 |
| 期待結果 | createdAtは元の値を維持 |

---

### toggleComplete(Long id) - 完了状態切り替え

#### TC-TC-001: 未完了→完了に切り替え

| 項目 | 内容 |
|------|------|
| テストケースID | TC-TC-001 |
| テスト観点 | 未完了から完了に切り替わること |
| 分類 | 正常系 |
| 前提条件 | ID=1が未完了 |
| 入力値 | id=1 |
| 期待結果 | completed=trueになる |

#### TC-TC-002: 完了→未完了に切り替え

| 項目 | 内容 |
|------|------|
| テストケースID | TC-TC-002 |
| テスト観点 | 完了から未完了に切り替わること |
| 分類 | 正常系 |
| 前提条件 | ID=1が完了状態 |
| 入力値 | id=1 |
| 期待結果 | completed=falseになる |

#### TC-TC-003: 存在しないIDで切り替え

| 項目 | 内容 |
|------|------|
| テストケースID | TC-TC-003 |
| テスト観点 | 存在しないIDでnullが返却されること |
| 分類 | 異常系 |
| 前提条件 | ID=999は存在しない |
| 入力値 | id=999 |
| 期待結果 | nullが返却される |

---

### deleteTodo(Long id) - 削除

#### TC-DT-001: 存在するToDoを削除

| 項目 | 内容 |
|------|------|
| テストケースID | TC-DT-001 |
| テスト観点 | 削除後に総数が減少すること |
| 分類 | 正常系 |
| 前提条件 | ID=1が存在、総数3 |
| 入力値 | id=1 |
| 期待結果 | 削除されたTodoが返却、総数が2に減少 |

#### TC-DT-002: 存在しないIDで削除

| 項目 | 内容 |
|------|------|
| テストケースID | TC-DT-002 |
| テスト観点 | 存在しないIDでnullが返却されること |
| 分類 | 異常系 |
| 前提条件 | ID=999は存在しない |
| 入力値 | id=999 |
| 期待結果 | nullが返却される |

---

### deleteAllTodos() - 全削除

#### TC-DA-001: 全ToDoを削除

| 項目 | 内容 |
|------|------|
| テストケースID | TC-DA-001 |
| テスト観点 | 全件削除後に総数が0になること |
| 分類 | 正常系 |
| 前提条件 | 3件が存在 |
| 入力値 | なし |
| 期待結果 | 総数が0になる |

---

### 統計メソッド (getTotalCount / getCompletedCount / getPendingCount)

#### TC-CN-001: 初期状態で総数取得

| 項目 | 内容 |
|------|------|
| テストケースID | TC-CN-001 |
| テスト観点 | 初期状態で正しい総数が返却されること |
| 分類 | 正常系 |
| 前提条件 | サンプル3件 |
| 入力値 | なし |
| 期待結果 | 3が返却される |

#### TC-CC-001: 初期状態で完了数取得

| 項目 | 内容 |
|------|------|
| テストケースID | TC-CC-001 |
| テスト観点 | 初期状態（全て未完了）で0が返却されること |
| 分類 | 正常系 |
| 前提条件 | サンプル3件（全て未完了） |
| 入力値 | なし |
| 期待結果 | 0が返却される |

#### TC-PC-001: 初期状態で未完了数取得

| 項目 | 内容 |
|------|------|
| テストケースID | TC-PC-001 |
| テスト観点 | 初期状態で正しい未完了数が返却されること |
| 分類 | 正常系 |
| 前提条件 | サンプル3件（全て未完了） |
| 入力値 | なし |
| 期待結果 | 3が返却される |

---

## 3. テストケース一覧

| ID | 対象 | テスト観点 | 分類 | 優先度 |
|----|------|-----------|------|--------|
| TC-GT-001 | getAllTodos | 初期状態で取得 | 正常系 | 高 |
| TC-GT-002 | getAllTodos | 全削除後に取得 | 境界値 | 中 |
| TC-GT-003 | getAllTodos | 新規追加後に取得 | 正常系 | 高 |
| TC-GC-001 | getTodosByCompleted | 未完了フィルタ | 正常系 | 高 |
| TC-GC-002 | getTodosByCompleted | 完了フィルタ | 正常系 | 高 |
| TC-GC-003 | getTodosByCompleted | 該当なし | 境界値 | 中 |
| TC-GI-001 | getTodoById | 存在するID | 正常系 | 高 |
| TC-GI-002 | getTodoById | 存在しないID | 異常系 | 高 |
| TC-CT-001 | createTodo | 正常作成 | 正常系 | 高 |
| TC-CT-002 | createTodo | 連続作成 | 正常系 | 中 |
| TC-UT-001 | updateTodo | 存在するID更新 | 正常系 | 高 |
| TC-UT-002 | updateTodo | 存在しないID更新 | 異常系 | 高 |
| TC-UT-003 | updateTodo | createdAt保持 | 境界値 | 中 |
| TC-TC-001 | toggleComplete | 未完了→完了 | 正常系 | 高 |
| TC-TC-002 | toggleComplete | 完了→未完了 | 正常系 | 高 |
| TC-TC-003 | toggleComplete | 存在しないID | 異常系 | 高 |
| TC-DT-001 | deleteTodo | 存在するID削除 | 正常系 | 高 |
| TC-DT-002 | deleteTodo | 存在しないID削除 | 異常系 | 高 |
| TC-DA-001 | deleteAllTodos | 全削除 | 正常系 | 高 |
| TC-CN-001 | getTotalCount | 初期状態 | 正常系 | 高 |
| TC-CC-001 | getCompletedCount | 初期状態 | 正常系 | 高 |
| TC-PC-001 | getPendingCount | 初期状態 | 正常系 | 高 |

---

## 4. テスト実行方法

```bash
# 全テスト実行
./mvnw test

# 特定クラスのテスト実行
./mvnw test -Dtest=TodoServiceTest
```

---

## 改版履歴

| 版数 | 日付 | 変更内容 | 変更者 |
|------|------|----------|--------|
| 1.0 | 2025-12-22 | 初版作成（既存テスト仕様書を案件形式に整理） | - |
