[← 目次に戻る](./README.md)

# 結合テスト・後方互換性テスト

## 4. 結合テスト（API）

### 4.1 UserController APIテスト

#### IT-01: GET /api/users - 正常系

| 項目 | 内容 |
|------|------|
| テストケースID | IT-01 |
| テスト観点 | ユーザー一覧が取得できること |
| エンドポイント | `GET /api/users` |
| 前提条件 | ユーザーが3件登録されている |
| リクエスト | なし |
| 期待結果 | ステータス: 200, 3件のユーザー配列 |

#### IT-02: GET /api/users/{id} - 正常系

| 項目 | 内容 |
|------|------|
| テストケースID | IT-02 |
| テスト観点 | 指定IDのユーザーが取得できること |
| エンドポイント | `GET /api/users/1` |
| 前提条件 | ID=1のユーザーが存在する |
| リクエスト | なし |
| 期待結果 | ステータス: 200, ユーザー情報 |

#### IT-03: GET /api/users/{id} - 異常系（404）

| 項目 | 内容 |
|------|------|
| テストケースID | IT-03 |
| テスト観点 | 存在しないIDで404が返却されること |
| エンドポイント | `GET /api/users/999` |
| 前提条件 | ID=999のユーザーは存在しない |
| リクエスト | なし |
| 期待結果 | ステータス: 404 |

#### IT-04: POST /api/users - 正常系

| 項目 | 内容 |
|------|------|
| テストケースID | IT-04 |
| テスト観点 | ユーザーが正常に登録されること |
| エンドポイント | `POST /api/users` |
| 前提条件 | なし |
| リクエスト | `{"name": "新規ユーザー"}` |
| 期待結果 | ステータス: 201, 作成されたユーザー情報 |

#### IT-05: POST /api/users - 異常系（名前空）

| 項目 | 内容 |
|------|------|
| テストケースID | IT-05 |
| テスト観点 | 名前が空の場合に400が返却されること |
| エンドポイント | `POST /api/users` |
| 前提条件 | なし |
| リクエスト | `{"name": ""}` |
| 期待結果 | ステータス: 400 |

#### IT-06: POST /api/users - 異常系（名前重複）

| 項目 | 内容 |
|------|------|
| テストケースID | IT-06 |
| テスト観点 | 名前重複時に409が返却されること |
| エンドポイント | `POST /api/users` |
| 前提条件 | 名前「山田太郎」のユーザーが存在する |
| リクエスト | `{"name": "山田太郎"}` |
| 期待結果 | ステータス: 409 |

#### IT-07: POST /api/users - 境界値（100文字）

| 項目 | 内容 |
|------|------|
| テストケースID | IT-07 |
| テスト観点 | 100文字の名前で登録できること |
| エンドポイント | `POST /api/users` |
| 前提条件 | なし |
| リクエスト | `{"name": "あ" × 100}` |
| 期待結果 | ステータス: 201 |

#### IT-08: POST /api/users - 境界値（101文字）

| 項目 | 内容 |
|------|------|
| テストケースID | IT-08 |
| テスト観点 | 101文字の名前で400が返却されること |
| エンドポイント | `POST /api/users` |
| 前提条件 | なし |
| リクエスト | `{"name": "あ" × 101}` |
| 期待結果 | ステータス: 400 |

#### IT-09: DELETE /api/users/{id} - 正常系

| 項目 | 内容 |
|------|------|
| テストケースID | IT-09 |
| テスト観点 | ユーザーが正常に削除されること |
| エンドポイント | `DELETE /api/users/1` |
| 前提条件 | ID=1のユーザーが存在する |
| リクエスト | なし |
| 期待結果 | ステータス: 204 |

#### IT-10: DELETE /api/users/{id} - 異常系（404）

| 項目 | 内容 |
|------|------|
| テストケースID | IT-10 |
| テスト観点 | 存在しないIDで404が返却されること |
| エンドポイント | `DELETE /api/users/999` |
| 前提条件 | ID=999のユーザーは存在しない |
| リクエスト | なし |
| 期待結果 | ステータス: 404 |

#### IT-11: DELETE /api/users/{id} - ToDo担当者解除

| 項目 | 内容 |
|------|------|
| テストケースID | IT-11 |
| テスト観点 | ユーザー削除時にToDoの担当者がNULLになること |
| エンドポイント | `DELETE /api/users/1` |
| 前提条件 | ID=1のユーザーがToDoに担当者として設定されている |
| リクエスト | なし |
| 期待結果 | ステータス: 204, ToDoのassigneeIdがnull |

---

### 4.2 TodoController APIテスト（変更分）

#### IT-20: POST /api/todos - 担当者付き作成

| 項目 | 内容 |
|------|------|
| テストケースID | IT-20 |
| テスト観点 | 担当者付きでToDoが作成できること |
| エンドポイント | `POST /api/todos` |
| 前提条件 | ID=1のユーザーが存在する |
| リクエスト | `{"title": "テスト", "assigneeId": 1}` |
| 期待結果 | ステータス: 201, assigneeId=1, assigneeName="山田太郎" |

#### IT-21: POST /api/todos - 担当者なし作成

| 項目 | 内容 |
|------|------|
| テストケースID | IT-21 |
| テスト観点 | 担当者なしでToDoが作成できること |
| エンドポイント | `POST /api/todos` |
| 前提条件 | なし |
| リクエスト | `{"title": "テスト"}` |
| 期待結果 | ステータス: 201, assigneeId=null |

#### IT-22: POST /api/todos - 異常系（存在しない担当者）

| 項目 | 内容 |
|------|------|
| テストケースID | IT-22 |
| テスト観点 | 存在しない担当者IDで400が返却されること |
| エンドポイント | `POST /api/todos` |
| 前提条件 | ID=999のユーザーは存在しない |
| リクエスト | `{"title": "テスト", "assigneeId": 999}` |
| 期待結果 | ステータス: 400 |

#### IT-23: PUT /api/todos/{id} - 担当者変更

| 項目 | 内容 |
|------|------|
| テストケースID | IT-23 |
| テスト観点 | ToDoの担当者を変更できること |
| エンドポイント | `PUT /api/todos/1` |
| 前提条件 | ID=1のToDo(assigneeId=1)が存在する |
| リクエスト | `{"title": "テスト", "assigneeId": 2}` |
| 期待結果 | ステータス: 200, assigneeId=2 |

#### IT-24: PUT /api/todos/{id} - 担当者解除

| 項目 | 内容 |
|------|------|
| テストケースID | IT-24 |
| テスト観点 | ToDoの担当者を解除できること |
| エンドポイント | `PUT /api/todos/1` |
| 前提条件 | ID=1のToDo(assigneeId=1)が存在する |
| リクエスト | `{"title": "テスト", "assigneeId": null}` |
| 期待結果 | ステータス: 200, assigneeId=null |

#### IT-25: GET /api/todos - 担当者情報取得

| 項目 | 内容 |
|------|------|
| テストケースID | IT-25 |
| テスト観点 | ToDo一覧に担当者名が含まれること |
| エンドポイント | `GET /api/todos` |
| 前提条件 | assigneeId=1のToDoが存在する |
| リクエスト | なし |
| 期待結果 | ステータス: 200, assigneeName="山田太郎" |

---

## 5. 後方互換性テスト

### 5.1 既存機能の動作確認

#### IT-30: 既存ToDo機能 - 作成

| 項目 | 内容 |
|------|------|
| テストケースID | IT-30 |
| テスト観点 | 既存のToDo作成が正常に動作すること |
| エンドポイント | `POST /api/todos` |
| 前提条件 | なし |
| リクエスト | `{"title": "テスト", "description": "説明"}` |
| 期待結果 | ステータス: 201 |

#### IT-31: 既存ToDo機能 - 完了切替

| 項目 | 内容 |
|------|------|
| テストケースID | IT-31 |
| テスト観点 | 既存の完了切替が正常に動作すること |
| エンドポイント | `PATCH /api/todos/1/toggle` |
| 前提条件 | ID=1のToDoが存在する |
| リクエスト | なし |
| 期待結果 | ステータス: 200, completedが反転 |

#### IT-32: 既存ToDo機能 - 削除

| 項目 | 内容 |
|------|------|
| テストケースID | IT-32 |
| テスト観点 | 既存のToDo削除が正常に動作すること |
| エンドポイント | `DELETE /api/todos/1` |
| 前提条件 | ID=1のToDoが存在する |
| リクエスト | なし |
| 期待結果 | ステータス: 204 |
