# 単体テスト

> [← 目次に戻る](./README.md)

## 1. ProjectServiceTest（新規）

**テスト対象**: `com.example.demo.ProjectService`

---

### getAllProjects() - 案件一覧取得

#### TC-PS-001: 案件一覧取得 - 正常系

| 項目 | 内容 |
|------|------|
| テストケースID | TC-PS-001 |
| テスト観点 | 登録済み案件が作成日時降順で取得できること |
| 分類 | 正常系 |
| 前提条件 | 案件が2件存在 |
| 入力値 | なし |
| 期待結果 | 2件が作成日時降順で返却される |

#### TC-PS-002: 案件一覧取得 - 0件

| 項目 | 内容 |
|------|------|
| テストケースID | TC-PS-002 |
| テスト観点 | 案件が0件の場合、空リストが返却されること |
| 分類 | 境界値 |
| 前提条件 | 案件が0件 |
| 入力値 | なし |
| 期待結果 | 空のリストが返却される |

---

### getProjectById(Long id) - 案件詳細取得

#### TC-PS-003: 存在するIDで取得

| 項目 | 内容 |
|------|------|
| テストケースID | TC-PS-003 |
| テスト観点 | 存在するIDで案件が取得できること |
| 分類 | 正常系 |
| 前提条件 | ID=1の案件が存在 |
| 入力値 | id=1 |
| 期待結果 | 該当のProjectが返却される |

#### TC-PS-004: 存在しないIDで取得

| 項目 | 内容 |
|------|------|
| テストケースID | TC-PS-004 |
| テスト観点 | 存在しないIDでnullが返却されること |
| 分類 | 異常系 |
| 前提条件 | ID=999は存在しない |
| 入力値 | id=999 |
| 期待結果 | nullが返却される |

---

### createProject(Project project) - 案件作成

#### TC-PS-005: 正常な案件作成

| 項目 | 内容 |
|------|------|
| テストケースID | TC-PS-005 |
| テスト観点 | 案件が正常に作成されIDが付与されること |
| 分類 | 正常系 |
| 前提条件 | name, descriptionを設定 |
| 入力値 | name="新規案件", description="説明" |
| 期待結果 | IDが自動採番され、作成されたProjectが返却される |

#### TC-PS-006: 説明なしで案件作成

| 項目 | 内容 |
|------|------|
| テストケースID | TC-PS-006 |
| テスト観点 | descriptionがnullでも作成できること |
| 分類 | 正常系 |
| 前提条件 | nameのみ設定 |
| 入力値 | name="案件名", description=null |
| 期待結果 | 案件が作成される |

---

### updateProject(Long id, Project updatedProject) - 案件更新

#### TC-PS-007: 存在する案件を更新

| 項目 | 内容 |
|------|------|
| テストケースID | TC-PS-007 |
| テスト観点 | 更新内容が正しく反映されること |
| 分類 | 正常系 |
| 前提条件 | ID=1が存在 |
| 入力値 | id=1, 更新内容 |
| 期待結果 | 更新されたProjectが返却、name/descriptionが変更される |

#### TC-PS-008: 存在しないIDで更新

| 項目 | 内容 |
|------|------|
| テストケースID | TC-PS-008 |
| テスト観点 | 存在しないIDでnullが返却されること |
| 分類 | 異常系 |
| 前提条件 | ID=999は存在しない |
| 入力値 | id=999 |
| 期待結果 | nullが返却される |

---

### deleteProject(Long id) - 案件削除

#### TC-PS-009: 案件削除（配下チケットなし）

| 項目 | 内容 |
|------|------|
| テストケースID | TC-PS-009 |
| テスト観点 | 配下チケットなしの案件が削除できること |
| 分類 | 正常系 |
| 前提条件 | ID=1が存在、配下チケット0件 |
| 入力値 | id=1 |
| 期待結果 | 削除されたProjectが返却、案件数が減少 |

#### TC-PS-010: 案件削除（配下チケットあり） - カスケード削除

| 項目 | 内容 |
|------|------|
| テストケースID | TC-PS-010 |
| テスト観点 | 案件削除時に配下チケットも削除されること |
| 分類 | 正常系 |
| 前提条件 | ID=1に3件のチケットが紐づく |
| 入力値 | id=1 |
| 期待結果 | 案件と配下3件のチケットがすべて削除される |

#### TC-PS-011: 存在しないIDで削除

| 項目 | 内容 |
|------|------|
| テストケースID | TC-PS-011 |
| テスト観点 | 存在しないIDでnullが返却されること |
| 分類 | 異常系 |
| 前提条件 | ID=999は存在しない |
| 入力値 | id=999 |
| 期待結果 | nullが返却される |

---

### getProjectStats(Long id) - 案件統計取得

#### TC-PS-012: 統計取得 - 全て未完了

| 項目 | 内容 |
|------|------|
| テストケースID | TC-PS-012 |
| テスト観点 | 全て未完了の場合の統計が正しいこと |
| 分類 | 正常系 |
| 前提条件 | 案件に3件のチケット（全て未完了） |
| 入力値 | id=1 |
| 期待結果 | total=3, completed=0, pending=3, progressRate=0 |

#### TC-PS-013: 統計取得 - 一部完了

| 項目 | 内容 |
|------|------|
| テストケースID | TC-PS-013 |
| テスト観点 | 一部完了の場合の統計・進捗率が正しいこと |
| 分類 | 正常系 |
| 前提条件 | 案件に10件のチケット（3件完了） |
| 入力値 | id=1 |
| 期待結果 | total=10, completed=3, pending=7, progressRate=30 |

#### TC-PS-014: 統計取得 - 全て完了

| 項目 | 内容 |
|------|------|
| テストケースID | TC-PS-014 |
| テスト観点 | 全て完了の場合の進捗率が100%であること |
| 分類 | 正常系 |
| 前提条件 | 案件に5件のチケット（全て完了） |
| 入力値 | id=1 |
| 期待結果 | total=5, completed=5, pending=0, progressRate=100 |

#### TC-PS-015: 統計取得 - チケット0件

| 項目 | 内容 |
|------|------|
| テストケースID | TC-PS-015 |
| テスト観点 | チケット0件の場合の進捗率が0%であること |
| 分類 | 境界値 |
| 前提条件 | 案件にチケット0件 |
| 入力値 | id=1 |
| 期待結果 | total=0, completed=0, pending=0, progressRate=0 |

#### TC-PS-016: 統計取得 - 進捗率の切り捨て

| 項目 | 内容 |
|------|------|
| テストケースID | TC-PS-016 |
| テスト観点 | 進捗率が小数点以下切り捨てになること |
| 分類 | 境界値 |
| 前提条件 | 案件に3件のチケット（1件完了）→ 33.33...% |
| 入力値 | id=1 |
| 期待結果 | progressRate=33（切り捨て） |

---

## 2. TodoServiceTest（変更分）

**テスト対象**: `com.example.demo.TodoService`

---

### getTodosByProjectId(Long projectId) - 案件別チケット取得（新規）

#### TC-TS-001: 案件IDでフィルタ取得

| 項目 | 内容 |
|------|------|
| テストケースID | TC-TS-001 |
| テスト観点 | 指定案件のチケットのみ取得できること |
| 分類 | 正常系 |
| 前提条件 | 案件1に3件、案件2に2件のチケット |
| 入力値 | projectId=1 |
| 期待結果 | 案件1の3件のみ返却される |

#### TC-TS-002: 案件未設定チケット取得

| 項目 | 内容 |
|------|------|
| テストケースID | TC-TS-002 |
| テスト観点 | projectId=nullのチケットが取得できること |
| 分類 | 正常系 |
| 前提条件 | 未分類チケット2件、案件1に3件 |
| 入力値 | projectId=null |
| 期待結果 | 未分類の2件のみ返却される |

#### TC-TS-003: 該当チケットなし

| 項目 | 内容 |
|------|------|
| テストケースID | TC-TS-003 |
| テスト観点 | 該当チケットがない場合、空リストが返却されること |
| 分類 | 境界値 |
| 前提条件 | 案件1にチケット0件 |
| 入力値 | projectId=1 |
| 期待結果 | 空のリストが返却される |

---

### validateDateRange(LocalDate startDate, LocalDate dueDate) - 日付バリデーション（新規）

#### TC-TS-004: 両方null - 正常

| 項目 | 内容 |
|------|------|
| テストケースID | TC-TS-004 |
| テスト観点 | 両方nullの場合、バリデーション通過すること |
| 分類 | 正常系 |
| 前提条件 | なし |
| 入力値 | startDate=null, dueDate=null |
| 期待結果 | 例外がスローされない |

#### TC-TS-005: 開始日のみ設定 - 正常

| 項目 | 内容 |
|------|------|
| テストケースID | TC-TS-005 |
| テスト観点 | 開始日のみ設定でも正常終了すること |
| 分類 | 正常系 |
| 前提条件 | なし |
| 入力値 | startDate=2025-01-01, dueDate=null |
| 期待結果 | 例外がスローされない |

#### TC-TS-006: 終了日のみ設定 - 正常

| 項目 | 内容 |
|------|------|
| テストケースID | TC-TS-006 |
| テスト観点 | 終了日のみ設定でも正常終了すること |
| 分類 | 正常系 |
| 前提条件 | なし |
| 入力値 | startDate=null, dueDate=2025-01-15 |
| 期待結果 | 例外がスローされない |

#### TC-TS-007: 開始日 < 終了日 - 正常

| 項目 | 内容 |
|------|------|
| テストケースID | TC-TS-007 |
| テスト観点 | 開始日より終了日が後の場合、正常終了すること |
| 分類 | 正常系 |
| 前提条件 | なし |
| 入力値 | startDate=2025-01-01, dueDate=2025-01-15 |
| 期待結果 | 例外がスローされない |

#### TC-TS-008: 開始日 = 終了日 - 正常

| 項目 | 内容 |
|------|------|
| テストケースID | TC-TS-008 |
| テスト観点 | 開始日と終了日が同日でも正常終了すること |
| 分類 | 境界値 |
| 前提条件 | なし |
| 入力値 | startDate=2025-01-01, dueDate=2025-01-01 |
| 期待結果 | 例外がスローされない |

#### TC-TS-009: 開始日 > 終了日 - 異常

| 項目 | 内容 |
|------|------|
| テストケースID | TC-TS-009 |
| テスト観点 | 開始日より終了日が前の場合、例外がスローされること |
| 分類 | 異常系 |
| 前提条件 | なし |
| 入力値 | startDate=2025-01-15, dueDate=2025-01-01 |
| 期待結果 | IllegalArgumentExceptionがスローされる |

---

### createTodo(Todo todo) - チケット作成（変更）

#### TC-TS-010: 期間指定でチケット作成

| 項目 | 内容 |
|------|------|
| テストケースID | TC-TS-010 |
| テスト観点 | 開始日・終了日・案件IDを設定してチケットが作成できること |
| 分類 | 正常系 |
| 前提条件 | 案件ID=1が存在 |
| 入力値 | title="タスク", projectId=1, startDate=2025-01-01, dueDate=2025-01-15 |
| 期待結果 | 全フィールドが設定されたチケットが作成される |

#### TC-TS-011: 期間なし・案件なしでチケット作成

| 項目 | 内容 |
|------|------|
| テストケースID | TC-TS-011 |
| テスト観点 | 期間・案件未設定でもチケットが作成できること |
| 分類 | 正常系 |
| 前提条件 | なし |
| 入力値 | title="タスク", projectId=null, startDate=null, dueDate=null |
| 期待結果 | チケットが作成される（後方互換性） |

#### TC-TS-012: 不正な期間でチケット作成失敗

| 項目 | 内容 |
|------|------|
| テストケースID | TC-TS-012 |
| テスト観点 | 開始日>終了日の場合、例外がスローされること |
| 分類 | 異常系 |
| 前提条件 | なし |
| 入力値 | startDate=2025-01-15, dueDate=2025-01-01 |
| 期待結果 | IllegalArgumentExceptionがスローされる |

---

### updateTodo(Long id, Todo updatedTodo) - チケット更新（変更）

#### TC-TS-013: 期間と案件を更新

| 項目 | 内容 |
|------|------|
| テストケースID | TC-TS-013 |
| テスト観点 | 開始日・終了日・案件IDが更新できること |
| 分類 | 正常系 |
| 前提条件 | ID=1が存在（期間・案件未設定） |
| 入力値 | id=1, projectId=2, startDate=2025-02-01, dueDate=2025-02-15 |
| 期待結果 | 更新された内容が反映される |

#### TC-TS-014: 期間をnullに更新（クリア）

| 項目 | 内容 |
|------|------|
| テストケースID | TC-TS-014 |
| テスト観点 | 期間設定済みをnullに更新できること |
| 分類 | 正常系 |
| 前提条件 | ID=1が期間設定済み |
| 入力値 | id=1, startDate=null, dueDate=null |
| 期待結果 | startDate, dueDateがnullに更新される |
