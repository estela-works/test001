# 結合テスト

> [← 目次に戻る](./README.md)

## 1. ProjectController APIテスト

### IT-PC-001: GET /api/projects - 案件一覧取得

| 項目 | 内容 |
|------|------|
| テストケースID | IT-PC-001 |
| テスト観点 | 案件一覧が正常に取得できること |
| エンドポイント | `GET /api/projects` |
| 前提条件 | 案件2件登録済み |
| リクエスト | なし |
| 期待結果 | ステータス: 200, レスポンス: 案件2件の配列 |

### IT-PC-002: POST /api/projects - 案件作成成功

| 項目 | 内容 |
|------|------|
| テストケースID | IT-PC-002 |
| テスト観点 | 案件が正常に作成できること |
| エンドポイント | `POST /api/projects` |
| 前提条件 | なし |
| リクエスト | `{"name": "新規案件", "description": "説明"}` |
| 期待結果 | ステータス: 201, レスポンス: 作成された案件（ID付き） |

### IT-PC-003: POST /api/projects - name未入力エラー

| 項目 | 内容 |
|------|------|
| テストケースID | IT-PC-003 |
| テスト観点 | name未入力で400エラーになること |
| エンドポイント | `POST /api/projects` |
| 前提条件 | なし |
| リクエスト | `{"name": "", "description": "説明"}` |
| 期待結果 | ステータス: 400 |

### IT-PC-004: GET /api/projects/{id} - 案件詳細取得

| 項目 | 内容 |
|------|------|
| テストケースID | IT-PC-004 |
| テスト観点 | 案件詳細が正常に取得できること |
| エンドポイント | `GET /api/projects/1` |
| 前提条件 | ID=1の案件が存在 |
| リクエスト | なし |
| 期待結果 | ステータス: 200, レスポンス: 案件詳細 |

### IT-PC-005: GET /api/projects/{id} - 存在しないID

| 項目 | 内容 |
|------|------|
| テストケースID | IT-PC-005 |
| テスト観点 | 存在しないIDで404エラーになること |
| エンドポイント | `GET /api/projects/999` |
| 前提条件 | ID=999は存在しない |
| リクエスト | なし |
| 期待結果 | ステータス: 404 |

### IT-PC-006: DELETE /api/projects/{id} - 案件削除成功

| 項目 | 内容 |
|------|------|
| テストケースID | IT-PC-006 |
| テスト観点 | 案件が正常に削除できること |
| エンドポイント | `DELETE /api/projects/1` |
| 前提条件 | ID=1の案件が存在 |
| リクエスト | なし |
| 期待結果 | ステータス: 204 |

### IT-PC-007: DELETE /api/projects/{id} - カスケード削除

| 項目 | 内容 |
|------|------|
| テストケースID | IT-PC-007 |
| テスト観点 | 案件削除時に配下チケットも削除されること |
| エンドポイント | `DELETE /api/projects/1` |
| 前提条件 | ID=1に3件のチケットが紐づく |
| リクエスト | なし |
| 期待結果 | ステータス: 204, 配下チケット3件も削除される |

### IT-PC-008: GET /api/projects/{id}/stats - 統計取得

| 項目 | 内容 |
|------|------|
| テストケースID | IT-PC-008 |
| テスト観点 | 案件統計が正常に取得できること |
| エンドポイント | `GET /api/projects/1/stats` |
| 前提条件 | ID=1に5件のチケット（2件完了） |
| リクエスト | なし |
| 期待結果 | ステータス: 200, レスポンス: `{"total":5, "completed":2, "pending":3, "progressRate":40}` |

---

## 2. TodoController APIテスト（変更分）

### IT-TC-001: GET /api/todos?projectId={id} - 案件別取得

| 項目 | 内容 |
|------|------|
| テストケースID | IT-TC-001 |
| テスト観点 | 案件IDでフィルタしたチケットが取得できること |
| エンドポイント | `GET /api/todos?projectId=1` |
| 前提条件 | 案件1に3件、案件2に2件のチケット |
| リクエスト | なし |
| 期待結果 | ステータス: 200, レスポンス: 案件1の3件のみ |

### IT-TC-002: GET /api/todos?projectId=none - 未分類取得

| 項目 | 内容 |
|------|------|
| テストケースID | IT-TC-002 |
| テスト観点 | 案件未設定のチケットが取得できること |
| エンドポイント | `GET /api/todos?projectId=none` |
| 前提条件 | 未分類2件、案件1に3件 |
| リクエスト | なし |
| 期待結果 | ステータス: 200, レスポンス: 未分類の2件のみ |

### IT-TC-003: POST /api/todos - 期間付きチケット作成

| 項目 | 内容 |
|------|------|
| テストケースID | IT-TC-003 |
| テスト観点 | 開始日・終了日付きのチケットが作成できること |
| エンドポイント | `POST /api/todos` |
| 前提条件 | 案件ID=1が存在 |
| リクエスト | `{"title": "タスク", "projectId": 1, "startDate": "2025-01-01", "dueDate": "2025-01-15"}` |
| 期待結果 | ステータス: 201, レスポンス: 全フィールドが設定されたチケット |

### IT-TC-004: POST /api/todos - 不正な期間でエラー

| 項目 | 内容 |
|------|------|
| テストケースID | IT-TC-004 |
| テスト観点 | 開始日>終了日で400エラーになること |
| エンドポイント | `POST /api/todos` |
| 前提条件 | なし |
| リクエスト | `{"title": "タスク", "startDate": "2025-01-15", "dueDate": "2025-01-01"}` |
| 期待結果 | ステータス: 400 |

### IT-TC-005: PUT /api/todos/{id} - 期間更新

| 項目 | 内容 |
|------|------|
| テストケースID | IT-TC-005 |
| テスト観点 | チケットの期間が更新できること |
| エンドポイント | `PUT /api/todos/1` |
| 前提条件 | ID=1が存在 |
| リクエスト | `{"title": "更新", "startDate": "2025-02-01", "dueDate": "2025-02-28"}` |
| 期待結果 | ステータス: 200, レスポンス: 更新後のチケット |

---

## 3. E2Eテスト（画面テスト）

### 3.1 案件一覧画面（SC-003）

| ID | テスト観点 | 操作 | 期待結果 |
|----|-----------|------|---------|
| E2E-P-001 | 案件一覧表示 | 画面を開く | 登録済み案件が一覧表示される |
| E2E-P-002 | 案件作成 | 名前入力→作成ボタン | 案件が追加され一覧に表示される |
| E2E-P-003 | 案件作成（名前空） | 名前未入力→作成ボタン | エラーメッセージが表示される |
| E2E-P-004 | 案件削除 | 削除ボタン→確認OK | 案件が一覧から消える |
| E2E-P-005 | 案件削除キャンセル | 削除ボタン→確認Cancel | 案件が残る |
| E2E-P-006 | チケット一覧遷移 | チケット一覧ボタン | ToDoリスト画面に遷移（案件フィルタ適用） |
| E2E-P-007 | 進捗率表示 | 案件一覧を表示 | 各案件の進捗率が正しく表示される |
| E2E-P-008 | 案件なし表示 | 画面を開く | 「案件なし」カードが表示される |

### 3.2 ToDoリスト画面（SC-002改修）

| ID | テスト観点 | 操作 | 期待結果 |
|----|-----------|------|---------|
| E2E-T-001 | 案件別表示 | ?projectId=1で遷移 | 案件1のチケットのみ表示 |
| E2E-T-002 | 未分類表示 | ?projectId=noneで遷移 | 未分類チケットのみ表示 |
| E2E-T-003 | 日付入力表示 | 画面を開く | 開始日・終了日入力欄が表示される |
| E2E-T-004 | 日付付きチケット作成 | 日付入力→追加 | 日付が設定されたチケットが作成される |
| E2E-T-005 | 期間表示 | チケット一覧を表示 | 期間が正しくフォーマットされて表示される |
| E2E-T-006 | 日付バリデーション | 終了日<開始日で追加 | エラーメッセージが表示される |
| E2E-T-007 | 案件一覧戻る | フッターリンク | 案件一覧画面に遷移 |
