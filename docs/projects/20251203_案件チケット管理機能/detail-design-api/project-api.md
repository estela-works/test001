[← 目次に戻る](./README.md)

# 案件API詳細（新規）

## 3.1 GET /api/projects - 案件一覧取得

| 項目 | 内容 |
|------|------|
| URL | `/api/projects` |
| メソッド | GET |
| 概要 | 全案件を作成日時降順で取得 |
| 対応機能 | F-002 |

### リクエスト

パラメータなし

### レスポンス

**成功時 (200)**:

```json
[
  {
    "id": 1,
    "name": "案件A",
    "description": "案件Aの説明",
    "createdAt": "2025-12-22T10:00:00"
  },
  {
    "id": 2,
    "name": "案件B",
    "description": null,
    "createdAt": "2025-12-21T15:30:00"
  }
]
```

| フィールド | 型 | 説明 |
|-----------|-----|------|
| id | Long | 案件ID |
| name | String | 案件名 |
| description | String | 説明（null可） |
| createdAt | LocalDateTime | 作成日時 |

---

## 3.2 GET /api/projects/{id} - 案件詳細取得

| 項目 | 内容 |
|------|------|
| URL | `/api/projects/{id}` |
| メソッド | GET |
| 概要 | 指定IDの案件を取得 |
| 対応機能 | F-003 |

### リクエスト

**パスパラメータ**:

| パラメータ | 型 | 必須 | 説明 |
|-----------|-----|------|------|
| id | Long | 要 | 案件ID |

### レスポンス

**成功時 (200)**:

```json
{
  "id": 1,
  "name": "案件A",
  "description": "案件Aの説明",
  "createdAt": "2025-12-22T10:00:00"
}
```

**エラー時**:

| ステータス | 条件 |
|-----------|------|
| 404 | 指定IDの案件が存在しない |

---

## 3.3 POST /api/projects - 案件作成

| 項目 | 内容 |
|------|------|
| URL | `/api/projects` |
| メソッド | POST |
| 概要 | 新しい案件を作成 |
| 対応機能 | F-001 |

### リクエスト

**リクエストボディ**:

```json
{
  "name": "案件名",
  "description": "案件の説明"
}
```

| フィールド | 型 | 必須 | 説明 | バリデーション |
|-----------|-----|------|------|---------------|
| name | String | 要 | 案件名 | 1〜100文字 |
| description | String | 任意 | 説明 | 500文字以内 |

### レスポンス

**成功時 (201)**:

```json
{
  "id": 1,
  "name": "案件名",
  "description": "案件の説明",
  "createdAt": "2025-12-22T10:00:00"
}
```

**エラー時**:

| ステータス | 条件 |
|-----------|------|
| 400 | nameが空またはnull |

### 処理フロー

1. リクエストボディを受信
2. nameの必須チェック
3. Projectエンティティを生成
4. ProjectService.create()を呼び出し
5. 201 Createdでレスポンス

---

## 3.4 PUT /api/projects/{id} - 案件更新

| 項目 | 内容 |
|------|------|
| URL | `/api/projects/{id}` |
| メソッド | PUT |
| 概要 | 既存の案件を更新 |
| 対応機能 | F-004 |

### リクエスト

**パスパラメータ**:

| パラメータ | 型 | 必須 | 説明 |
|-----------|-----|------|------|
| id | Long | 要 | 案件ID |

**リクエストボディ**:

```json
{
  "name": "更新後案件名",
  "description": "更新後説明"
}
```

| フィールド | 型 | 必須 | 説明 | バリデーション |
|-----------|-----|------|------|---------------|
| name | String | 要 | 案件名 | 1〜100文字 |
| description | String | 任意 | 説明 | 500文字以内 |

### レスポンス

**成功時 (200)**:

```json
{
  "id": 1,
  "name": "更新後案件名",
  "description": "更新後説明",
  "createdAt": "2025-12-22T10:00:00"
}
```

**エラー時**:

| ステータス | 条件 |
|-----------|------|
| 400 | nameが空またはnull |
| 404 | 指定IDの案件が存在しない |

---

## 3.5 DELETE /api/projects/{id} - 案件削除

| 項目 | 内容 |
|------|------|
| URL | `/api/projects/{id}` |
| メソッド | DELETE |
| 概要 | 案件を削除（配下のチケットも削除） |
| 対応機能 | F-005 |

### リクエスト

**パスパラメータ**:

| パラメータ | 型 | 必須 | 説明 |
|-----------|-----|------|------|
| id | Long | 要 | 案件ID |

### レスポンス

**成功時 (204)**:

レスポンスボディなし

**エラー時**:

| ステータス | 条件 |
|-----------|------|
| 404 | 指定IDの案件が存在しない |

### 処理フロー

1. パスパラメータからIDを取得
2. 案件の存在チェック
3. @Transactionalで以下を実行:
   - 配下のチケットを全削除
   - 案件を削除
4. 204 No Contentでレスポンス

---

## 3.6 GET /api/projects/{id}/stats - 案件統計取得

| 項目 | 内容 |
|------|------|
| URL | `/api/projects/{id}/stats` |
| メソッド | GET |
| 概要 | 案件の統計情報（チケット数、進捗率）を取得 |
| 対応機能 | F-006 |

### リクエスト

**パスパラメータ**:

| パラメータ | 型 | 必須 | 説明 |
|-----------|-----|------|------|
| id | Long | 要 | 案件ID |

### レスポンス

**成功時 (200)**:

```json
{
  "total": 10,
  "completed": 3,
  "pending": 7,
  "progressRate": 30
}
```

| フィールド | 型 | 説明 |
|-----------|-----|------|
| total | Integer | 総チケット数 |
| completed | Integer | 完了チケット数 |
| pending | Integer | 未完了チケット数 |
| progressRate | Integer | 進捗率（%、小数点以下切り捨て） |

**エラー時**:

| ステータス | 条件 |
|-----------|------|
| 404 | 指定IDの案件が存在しない |
