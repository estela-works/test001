# フロントエンド基本設計書

## 案件情報

| 項目 | 内容 |
|------|------|
| 案件名 | 案件チケット管理機能 |
| 案件ID | 20251201_案件チケット管理機能 |
| 作成日 | 2025-12-22 |
| 関連要件整理書 | [requirements.md](./requirements.md) |

---

## 1. 概要

### 1.1 本設計書の目的

案件管理機能およびチケット期間設定機能に関するフロントエンドの画面・UI・操作フローの基本設計を定義する。

### 1.2 フロントエンドの役割

| 責務 | 説明 |
|------|------|
| 画面表示 | 案件一覧・チケット一覧（期間情報含む）の表示 |
| ユーザー操作 | 案件の作成・削除、チケットへの期間設定 |
| API連携 | 案件API・チケットAPIとの通信 |

---

## 2. 技術要件

### 2.1 使用技術

| 項目 | 技術 |
|------|------|
| マークアップ | HTML5 |
| スタイル | CSS3 |
| スクリプト | Vanilla JavaScript（既存踏襲） |
| API通信 | Fetch API |

---

## 3. 画面要件

### 3.1 画面一覧

| ID | 画面名 | パス | 概要 | 対応US | 種別 |
|----|--------|------|------|--------|------|
| SC-003 | 案件一覧画面 | `/projects.html` | 案件の一覧表示・作成・削除 | US-001, US-002, US-007 | 新規 |
| SC-002 | ToDoリスト画面 | `/todos.html` | チケット管理（期間設定対応） | US-003, US-004, US-005 | 改修 |

### 3.2 画面遷移

```
┌─────────────┐          ┌─────────────────┐          ┌─────────────────┐
│  ホーム画面  │ ──────→ │   案件一覧画面   │ ──────→ │  ToDoリスト画面  │
│     (/)     │          │ (/projects.html) │          │  (/todos.html)  │
└─────────────┘          └─────────────────┘          └─────────────────┘
                                  │                           │
                                  │ ← 戻る                    │ ← 戻る
                                  ▼                           ▼
                         ┌─────────────┐             ┌─────────────────┐
                         │  ホーム画面  │             │   案件一覧画面   │
                         └─────────────┘             └─────────────────┘
```

---

## 4. 画面詳細

### 4.1 SC-003: 案件一覧画面（新規）

| 項目 | 内容 |
|------|------|
| パス | `/projects.html` |
| 目的 | 案件の一覧表示、新規作成、削除を行う |

#### レイアウト

```
┌─────────────────────────────────────────────────┐
│                  📁 案件一覧                     │  ← ヘッダー
├─────────────────────────────────────────────────┤
│  新しい案件を作成                                │
│  [案件名入力                                ]   │  ← 追加フォーム
│  [説明入力（任意）                          ]   │
│  [作成]                                        │
├─────────────────────────────────────────────────┤
│  ┌───────────────────────────────────────────┐ │
│  │ 案件名                                     │ │
│  │ 説明                                      │ │  ← 案件カード
│  │ チケット: X件  完了: X件  進捗: XX%        │ │
│  │ [チケット一覧] [削除]                      │ │
│  └───────────────────────────────────────────┘ │
│                                                 │
│  ┌───────────────────────────────────────────┐ │
│  │ 案件なし（未分類）                         │ │  ← 案件なし固定カード
│  │ チケット: X件  完了: X件                   │ │
│  │ [チケット一覧]                            │ │
│  └───────────────────────────────────────────┘ │
├─────────────────────────────────────────────────┤
│               ← ホームに戻る                    │  ← フッター
└─────────────────────────────────────────────────┘
```

#### 構成要素

| 要素ID | 要素名 | 種別 | 説明 | 機能 |
|--------|--------|------|------|------|
| E-301 | ヘッダー | テキスト | 画面タイトル表示 | - |
| E-302 | 案件名入力 | input[text] | 案件名入力欄 | 必須入力 |
| E-303 | 説明入力 | input[text] | 案件説明入力欄 | 任意入力 |
| E-304 | 作成ボタン | button | 案件作成実行 | 新規作成 |
| E-305 | 案件カード | カード | 案件情報・進捗表示 | 選択・削除 |
| E-306 | チケット一覧ボタン | button | 案件のチケット一覧へ遷移 | 画面遷移 |
| E-307 | 削除ボタン | button | 案件削除 | 削除（確認あり） |
| E-308 | 案件なしカード | カード | 未分類チケット表示 | 選択 |
| E-309 | フッター | リンク | ホームへのリンク | 画面遷移 |

#### イベント一覧

| イベントID | イベント名 | トリガー | 処理概要 |
|-----------|-----------|---------|---------|
| EV-003-01 | 初期読込 | ページロード | 案件一覧・統計を取得して表示 |
| EV-003-02 | 案件作成 | 作成ボタン/Enter | 新規案件を作成 |
| EV-003-03 | 案件削除 | 削除ボタン | 確認後、案件と配下チケットを削除 |
| EV-003-04 | チケット一覧遷移 | チケット一覧ボタン | ToDoリスト画面へ遷移（案件IDパラメータ付き） |
| EV-003-05 | ホーム遷移 | フッターリンク | ホーム画面へ遷移 |

---

### 4.2 SC-002: ToDoリスト画面（改修）

| 項目 | 内容 |
|------|------|
| パス | `/todos.html?projectId={id}` または `/todos.html?projectId=none` |
| 目的 | 案件に紐づくチケットの管理、開始日・終了日の設定 |

#### レイアウト（改修後）

```
┌─────────────────────────────────────────────────┐
│            📝 ToDoリスト - 案件名                │  ← ヘッダー（案件名表示追加）
├─────────────────────────────────────────────────┤
│         総数: X   完了: X   未完了: X            │  ← 統計エリア
├─────────────────────────────────────────────────┤
│  新しいToDoを追加                                │
│  [タイトル入力                              ]   │
│  [説明入力（任意）                          ]   │
│  開始日: [____-__-__]  終了日: [____-__-__]    │  ← 日付入力欄（追加）
│  [追加]                                        │
├─────────────────────────────────────────────────┤
│       [すべて] [未完了] [完了済み]               │  ← フィルタボタン
├─────────────────────────────────────────────────┤
│  ┌───────────────────────────────────────────┐ │
│  │ タイトル                                   │ │
│  │ 説明                                      │ │
│  │ 期間: 2025/01/01 〜 2025/01/15            │ │  ← 期間表示（追加）
│  │ 作成日: 2025/01/01                        │ │
│  │ [完了にする] [削除]                        │ │
│  └───────────────────────────────────────────┘ │
├─────────────────────────────────────────────────┤
│               ← 案件一覧に戻る                  │  ← フッター（遷移先変更）
└─────────────────────────────────────────────────┘
```

#### 構成要素（追加・変更分）

| 要素ID | 要素名 | 種別 | 説明 | 変更種別 |
|--------|--------|------|------|---------|
| E-201 | ヘッダー | テキスト | 案件名を含むタイトル表示 | 変更 |
| E-209 | 開始日入力 | input[date] | 開始日入力欄 | 追加 |
| E-210 | 終了日入力 | input[date] | 終了日入力欄 | 追加 |
| E-211 | 期間表示 | テキスト | カード内の期間表示 | 追加 |
| E-208 | フッター | リンク | 案件一覧へのリンク | 変更 |

#### URLパラメータ

| パラメータ | 型 | 説明 |
|-----------|-----|------|
| projectId | Long / "none" | 案件ID。"none"の場合は案件未設定チケットを表示 |

#### イベント一覧（追加・変更分）

| イベントID | イベント名 | トリガー | 処理概要 | 変更種別 |
|-----------|-----------|---------|---------|---------|
| EV-002-01 | 初期読込 | ページロード | projectIdパラメータで案件別チケット取得 | 変更 |
| EV-002-03 | ToDo追加 | 追加ボタン/Enter | 開始日・終了日・案件IDを含めて作成 | 変更 |
| EV-002-08 | 案件一覧遷移 | フッターリンク | 案件一覧画面へ遷移 | 追加 |

---

## 5. 共通UI要件

### 5.1 共通コンポーネント

| コンポーネント | 用途 |
|--------------|------|
| カード | 案件・チケットの情報表示 |
| 日付入力 | 開始日・終了日の入力（input[type="date"]） |
| 確認ダイアログ | 削除時の確認（confirm使用） |
| エラーメッセージ | バリデーションエラー表示 |

### 5.2 UI状態

| 状態 | 表示 |
|------|------|
| ローディング中 | 「読み込み中...」テキスト表示 |
| エラー発生時 | 赤背景のエラーメッセージ（5秒後に自動消去） |
| データなし | 「案件がありません」「チケットがありません」テキスト表示 |

### 5.3 日付表示フォーマット

| 用途 | フォーマット | 例 |
|------|-------------|-----|
| 入力 | YYYY-MM-DD | 2025-01-15 |
| 表示 | YYYY/MM/DD | 2025/01/15 |
| 期間表示 | YYYY/MM/DD 〜 YYYY/MM/DD | 2025/01/01 〜 2025/01/15 |

---

## 6. バリデーション要件

### 6.1 案件フォーム

| 項目 | ルール | エラーメッセージ |
|------|--------|----------------|
| 案件名 | 必須、1〜100文字 | 「案件名を入力してください」 |
| 説明 | 任意、500文字以内 | 「説明は500文字以内で入力してください」 |

### 6.2 チケットフォーム（追加分）

| 項目 | ルール | エラーメッセージ |
|------|--------|----------------|
| 開始日 | 任意、日付形式 | 「正しい日付を入力してください」 |
| 終了日 | 任意、日付形式 | 「正しい日付を入力してください」 |
| 期間整合性 | 終了日 >= 開始日 | 「終了日は開始日以降を指定してください」 |

---

## 7. 非機能要件

### 7.1 ユーザビリティ

| 項目 | 要件 |
|------|------|
| 応答性 | 操作に対して即座にUIが反応する |
| フィードバック | API通信中はローディング表示 |
| 確認 | 削除操作は確認ダイアログを表示 |

### 7.2 アクセシビリティ

| 項目 | 対応 |
|------|------|
| キーボード操作 | Enterキーでフォーム送信 |
| フォーカス管理 | フォーム送信後は入力欄にフォーカス |

---

## 8. 制約条件

| 項目 | 制約 |
|------|------|
| 対応ブラウザ | Chrome/Firefox/Edge/Safari 最新版 |
| レスポンシブ | 非対応（デスクトップ優先） |
| 日付入力 | ブラウザネイティブのdate input使用 |

---

## 9. ファイル構成

### 9.1 新規ファイル

| ファイル | 説明 |
|---------|------|
| `src/main/resources/static/projects.html` | 案件一覧画面 |
| `src/main/resources/static/js/projects.js` | 案件一覧画面のスクリプト |
| `src/main/resources/static/css/projects.css` | 案件一覧画面のスタイル（任意） |

### 9.2 変更ファイル

| ファイル | 変更内容 |
|---------|---------|
| `src/main/resources/static/todos.html` | 日付入力欄追加、ヘッダー・フッター変更 |
| `src/main/resources/static/js/todos.js` | 日付処理追加、案件フィルタ対応 |
| `src/main/resources/static/index.html` | 案件一覧へのリンク追加 |

---

## 改版履歴

| 版数 | 日付 | 変更内容 | 変更者 |
|------|------|----------|--------|
| 1.0 | 2025-12-22 | 初版作成 | - |
