# フロントエンド基本設計書

## 案件情報

| 項目 | 内容 |
|------|------|
| 案件名 | Vue.js移行・フロントエンド/バックエンド分離 |
| 案件ID | 20241224_vue-migration |
| 作成日 | 2024-12-24 |
| 関連要件整理書 | [requirements.md](./requirements.md) |

---

## 1. 概要

### 1.1 本設計書の目的

Vue.js 3ベースの新フロントエンドアーキテクチャを定義する。既存のバニラJavaScript実装からの移行方針と、コンポーネント設計の基本方針を示す。

### 1.2 フロントエンドの役割

| 責務 | 説明 |
|------|------|
| 画面表示 | VueコンポーネントによるリアクティブなUI描画 |
| ユーザー操作 | フォーム入力・ボタン操作の受付とバリデーション |
| 状態管理 | Piniaストアによる画面横断的な状態の一元管理 |
| API連携 | Fetch APIによるバックエンドREST APIとの通信 |
| ルーティング | Vue Routerによるクライアントサイドルーティング |

---

## 2. 技術要件

### 2.1 使用技術

| 項目 | 技術 | バージョン |
|------|------|-----------|
| フレームワーク | Vue.js | 3.x |
| 言語 | TypeScript | 5.x |
| 状態管理 | Pinia | 2.x |
| ルーティング | Vue Router | 4.x |
| ビルドツール | Vite | 5.x |
| API通信 | Fetch API | ブラウザ標準 |
| テスト | Vitest | 1.x |
| Linter | ESLint | 8.x |
| Formatter | Prettier | 3.x |

### 2.2 開発サーバー構成

| 環境 | URL | 説明 |
|------|-----|------|
| フロントエンド開発サーバー | http://localhost:5173 | Vite dev server |
| バックエンドAPI | http://localhost:8080 | Spring Boot |

開発時はViteのプロキシ機能でAPIリクエストをバックエンドに転送する。

---

## 3. 画面要件

### 3.1 画面一覧

| ID | 画面名 | パス | 概要 | 対応US |
|----|--------|------|------|--------|
| SC-001 | トップページ | / | ナビゲーションハブ。各機能への導線を提供 | US-004 |
| SC-002 | ToDo管理画面 | /todos | ToDo一覧表示・CRUD操作・フィルタリング | US-004 |
| SC-003 | 案件管理画面 | /projects | 案件一覧表示・CRUD操作・進捗表示 | US-004 |
| SC-004 | 担当者管理画面 | /users | 担当者一覧表示・追加・削除 | US-004 |

### 3.2 画面遷移

```
┌─────────────────┐
│   トップページ    │
│    (SC-001)     │
└────────┬────────┘
         │
    ┌────┼────┐
    │    │    │
    ▼    ▼    ▼
┌──────┐ ┌──────┐ ┌──────┐
│ ToDo │ │ 案件 │ │ 担当者│
│SC-002│ │SC-003│ │SC-004│
└──────┘ └──────┘ └──────┘
    │         │
    │    ┌────┘
    ▼    ▼
┌──────────────┐
│ ToDo管理画面  │
│（案件フィルタ）│
└──────────────┘
```

**遷移パターン**:
- トップページ → 各管理画面（ナビゲーションカード）
- 案件管理 → ToDo管理（案件IDをクエリパラメータで渡す）
- 各画面 → トップページ（戻るリンク）

---

## 4. 画面詳細

### 4.1 SC-001: トップページ

| 項目 | 内容 |
|------|------|
| パス | / |
| 目的 | アプリケーションのエントリーポイント。各機能への導線 |

#### レイアウト

```
┌─────────────────────────────────────────┐
│              ヘッダー                    │
│         アプリケーション名               │
├─────────────────────────────────────────┤
│  ┌─────────────────────────────────┐   │
│  │  チケット管理カード               │   │
│  └─────────────────────────────────┘   │
│  ┌─────────────────────────────────┐   │
│  │  案件管理カード                   │   │
│  └─────────────────────────────────┘   │
│  ┌─────────────────────────────────┐   │
│  │  担当者管理カード                 │   │
│  └─────────────────────────────────┘   │
├─────────────────────────────────────────┤
│              フッター                    │
└─────────────────────────────────────────┘
```

#### 構成要素

| 要素 | 説明 | 機能 |
|------|------|------|
| ヘッダー | アプリ名・サブタイトル表示 | - |
| ナビカード（チケット） | アイコン・説明・遷移ボタン | /todos へ遷移 |
| ナビカード（案件） | アイコン・説明・遷移ボタン | /projects へ遷移 |
| ナビカード（担当者） | アイコン・説明・遷移ボタン | /users へ遷移 |
| フッター | コピーライト表示 | - |

---

### 4.2 SC-002: ToDo管理画面

| 項目 | 内容 |
|------|------|
| パス | /todos |
| クエリパラメータ | projectId（任意）: 案件でフィルタ |
| 目的 | ToDoの一覧表示・作成・編集・削除・フィルタリング |

#### レイアウト

```
┌─────────────────────────────────────────┐
│              ヘッダー                    │
│         ToDoリスト / 案件名              │
├─────────────────────────────────────────┤
│  ┌─────────────────────────────────┐   │
│  │  統計バー（総数/完了/未完了）    │   │
│  └─────────────────────────────────┘   │
├─────────────────────────────────────────┤
│  ┌─────────────────────────────────┐   │
│  │  新規ToDo追加フォーム            │   │
│  │  - タイトル入力                  │   │
│  │  - 説明入力                     │   │
│  │  - 開始日/終了日                │   │
│  │  - 担当者選択                   │   │
│  │  - 追加ボタン                   │   │
│  └─────────────────────────────────┘   │
├─────────────────────────────────────────┤
│  [すべて] [未完了] [完了済み]           │
├─────────────────────────────────────────┤
│  ┌─────────────────────────────────┐   │
│  │  ToDoアイテム 1                 │   │
│  │  - タイトル/説明/期間/担当者    │   │
│  │  - [完了にする] [削除]          │   │
│  └─────────────────────────────────┘   │
│  ┌─────────────────────────────────┐   │
│  │  ToDoアイテム 2                 │   │
│  └─────────────────────────────────┘   │
├─────────────────────────────────────────┤
│         ← 案件一覧に戻る                │
└─────────────────────────────────────────┘
```

#### 構成要素

| 要素 | 説明 | 機能 |
|------|------|------|
| ヘッダー | ページタイトル・案件名 | 案件情報をAPIから取得して表示 |
| 統計バー | 総数/完了/未完了の件数 | リアルタイム更新 |
| 追加フォーム | タイトル・説明・日付・担当者 | ToDo作成、バリデーション |
| フィルタボタン | すべて/未完了/完了済み | 表示切替（ローカル状態） |
| ToDoリスト | ToDo一覧表示 | 完了切替・削除 |
| 戻るリンク | 案件一覧へ | /projects へ遷移 |

---

### 4.3 SC-003: 案件管理画面

| 項目 | 内容 |
|------|------|
| パス | /projects |
| 目的 | 案件の一覧表示・作成・削除・進捗確認 |

#### レイアウト

```
┌─────────────────────────────────────────┐
│              ヘッダー                    │
│            案件一覧                      │
├─────────────────────────────────────────┤
│  ┌─────────────────────────────────┐   │
│  │  新規案件作成フォーム            │   │
│  │  - 案件名入力                   │   │
│  │  - 説明入力                     │   │
│  │  - 作成ボタン                   │   │
│  └─────────────────────────────────┘   │
├─────────────────────────────────────────┤
│  ┌─────────────────────────────────┐   │
│  │  案件カード 1                   │   │
│  │  - 案件名/説明                  │   │
│  │  - チケット数/完了数/進捗率     │   │
│  │  - プログレスバー               │   │
│  │  - [チケット一覧] [削除]        │   │
│  └─────────────────────────────────┘   │
│  ┌─────────────────────────────────┐   │
│  │  案件なし（未分類）カード        │   │
│  └─────────────────────────────────┘   │
├─────────────────────────────────────────┤
│     ユーザー管理 | ← ホームに戻る        │
└─────────────────────────────────────────┘
```

#### 構成要素

| 要素 | 説明 | 機能 |
|------|------|------|
| 作成フォーム | 案件名・説明 | 案件作成 |
| 案件カード | 案件情報・進捗 | チケット一覧へ遷移・削除 |
| 未分類カード | 案件なしチケット | チケット一覧へ遷移（projectId=none） |
| ナビリンク | ユーザー管理/ホーム | 画面遷移 |

---

### 4.4 SC-004: 担当者管理画面

| 項目 | 内容 |
|------|------|
| パス | /users |
| 目的 | 担当者の一覧表示・追加・削除 |

#### レイアウト

```
┌─────────────────────────────────────────┐
│              ヘッダー                    │
│           ユーザー管理                   │
├─────────────────────────────────────────┤
│  ┌─────────────────────────────────┐   │
│  │  統計バー（登録ユーザー数）      │   │
│  └─────────────────────────────────┘   │
├─────────────────────────────────────────┤
│  ┌─────────────────────────────────┐   │
│  │  新規ユーザー追加フォーム        │   │
│  │  - ユーザー名入力               │   │
│  │  - 追加ボタン                   │   │
│  └─────────────────────────────────┘   │
├─────────────────────────────────────────┤
│  ┌─────────────────────────────────┐   │
│  │  ユーザーカード 1               │   │
│  │  - ユーザー名/登録日            │   │
│  │  - [削除]                      │   │
│  └─────────────────────────────────┘   │
├─────────────────────────────────────────┤
│         ← 案件一覧に戻る                │
└─────────────────────────────────────────┘
```

#### 構成要素

| 要素 | 説明 | 機能 |
|------|------|------|
| 統計バー | 登録ユーザー数 | リアルタイム更新 |
| 追加フォーム | ユーザー名入力 | ユーザー作成、バリデーション |
| ユーザーカード | ユーザー情報 | 削除（確認ダイアログ付き） |
| 戻るリンク | 案件一覧へ | /projects へ遷移 |

---

## 5. コンポーネント設計

### 5.1 コンポーネント構成

```
src/
├── components/           # 共通コンポーネント
│   ├── common/
│   │   ├── AppHeader.vue       # アプリケーションヘッダー
│   │   ├── AppFooter.vue       # フッター
│   │   ├── LoadingSpinner.vue  # ローディング表示
│   │   ├── ErrorMessage.vue    # エラーメッセージ表示
│   │   └── ConfirmDialog.vue   # 確認ダイアログ
│   ├── todo/
│   │   ├── TodoForm.vue        # ToDo追加フォーム
│   │   ├── TodoItem.vue        # ToDoアイテム表示
│   │   ├── TodoList.vue        # ToDoリスト
│   │   ├── TodoStats.vue       # 統計表示
│   │   └── TodoFilter.vue      # フィルタボタン
│   ├── project/
│   │   ├── ProjectForm.vue     # 案件追加フォーム
│   │   ├── ProjectCard.vue     # 案件カード
│   │   └── ProjectList.vue     # 案件リスト
│   └── user/
│       ├── UserForm.vue        # ユーザー追加フォーム
│       ├── UserCard.vue        # ユーザーカード
│       └── UserList.vue        # ユーザーリスト
│
├── views/                # ページコンポーネント
│   ├── HomeView.vue           # トップページ
│   ├── TodoView.vue           # ToDo管理画面
│   ├── ProjectView.vue        # 案件管理画面
│   └── UserView.vue           # 担当者管理画面
│
├── stores/               # Piniaストア
│   ├── todoStore.ts           # ToDo状態管理
│   ├── projectStore.ts        # 案件状態管理
│   └── userStore.ts           # ユーザー状態管理
│
├── composables/          # 共通ロジック
│   ├── useApi.ts              # API呼び出しヘルパー
│   ├── useError.ts            # エラーハンドリング
│   └── useConfirm.ts          # 確認ダイアログ
│
├── services/             # APIサービス
│   ├── todoService.ts         # ToDo API
│   ├── projectService.ts      # 案件 API
│   └── userService.ts         # ユーザー API
│
├── types/                # 型定義
│   ├── todo.ts                # ToDo型
│   ├── project.ts             # 案件型
│   └── user.ts                # ユーザー型
│
├── router/               # ルーター設定
│   └── index.ts
│
├── App.vue               # ルートコンポーネント
└── main.ts               # エントリーポイント
```

### 5.2 共通コンポーネント

| コンポーネント | 用途 | Props |
|--------------|------|-------|
| LoadingSpinner | データ取得中の表示 | - |
| ErrorMessage | エラーメッセージ表示 | message: string |
| ConfirmDialog | 削除確認など | title, message, onConfirm |

### 5.3 UI状態

| 状態 | 表示 |
|------|------|
| ローディング中 | LoadingSpinner表示、フォーム無効化 |
| エラー発生時 | ErrorMessage表示（5秒後自動非表示） |
| データなし | 「データがありません」メッセージ表示 |

---

## 6. 状態管理設計

### 6.1 ストア構成

#### todoStore

```typescript
interface TodoState {
  todos: Todo[];
  loading: boolean;
  error: string | null;
  filter: 'all' | 'pending' | 'completed';
  currentProjectId: string | null;
}

// アクション
- fetchTodos(projectId?: string): Promise<void>
- addTodo(todo: CreateTodoRequest): Promise<void>
- toggleTodo(id: number): Promise<void>
- deleteTodo(id: number): Promise<void>
- setFilter(filter: string): void

// ゲッター
- filteredTodos: Todo[]
- stats: { total: number, completed: number, pending: number }
```

#### projectStore

```typescript
interface ProjectState {
  projects: Project[];
  loading: boolean;
  error: string | null;
}

// アクション
- fetchProjects(): Promise<void>
- createProject(project: CreateProjectRequest): Promise<void>
- deleteProject(id: number): Promise<void>
- fetchProjectStats(id: number): Promise<ProjectStats>
```

#### userStore

```typescript
interface UserState {
  users: User[];
  loading: boolean;
  error: string | null;
}

// アクション
- fetchUsers(): Promise<void>
- addUser(name: string): Promise<void>
- deleteUser(id: number): Promise<void>

// ゲッター
- userCount: number
```

---

## 7. 非機能要件

### 7.1 ユーザビリティ

| 項目 | 要件 |
|------|------|
| 応答性 | ボタン操作に対して即座に視覚的フィードバック |
| ローディング表示 | API通信中はスピナー表示 |
| エラー表示 | エラー時は赤いバナーで5秒間表示 |
| キーボード操作 | Enterキーでフォーム送信対応 |

### 7.2 アクセシビリティ

| 項目 | 対応 |
|------|------|
| セマンティックHTML | header, nav, main, footer タグ使用 |
| フォームラベル | すべての入力にlabel関連付け |
| フォーカス管理 | キーボード操作でフォーカス可視化 |

---

## 8. 制約条件

| 項目 | 制約 |
|------|------|
| 対応ブラウザ | Chrome, Firefox, Edge 最新版 |
| レスポンシブ | 800px幅固定（既存デザイン維持） |
| CSSフレームワーク | 使用しない（既存スタイル移植） |

---

## 改版履歴

| 版数 | 日付 | 変更内容 | 変更者 |
|------|------|----------|--------|
| 1.0 | 2024-12-24 | 初版作成 | - |
