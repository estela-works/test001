# バックエンド基本設計書

## 案件情報

| 項目 | 内容 |
|------|------|
| 案件名 | チケット一覧画面 |
| 案件ID | 20251226_チケット一覧画面 |
| 作成日 | 2025-12-26 |
| 関連要件整理書 | [requirements.md](./requirements.md) |

---

## 1. 概要

### 1.1 本設計書の目的

バックエンドが担う機能・データ・APIの基本設計を定義する。

### 1.2 バックエンドの役割

| 責務 | 本案件での変更 |
|------|---------------|
| データ管理 | **変更なし** |
| ビジネスロジック | **変更なし** |
| API提供 | **変更なし** |
| バリデーション | **変更なし** |

### 1.3 変更なしの理由

本案件はフロントエンドのみの改善であり、以下の理由によりバックエンドの変更は不要である:

1. **既存APIで対応可能**: `GET /api/todos` で全チケットを取得し、フロントエンドでフィルタ・検索・ソートを実装する
2. **データ量が少ない**: 現時点では数百件程度を想定しており、全件取得後のフロントエンド処理で十分なパフォーマンスが得られる
3. **新規データモデル不要**: チケット、ユーザー、案件の既存データモデルをそのまま活用
4. **DBスキーマ変更なし**: 検索・フィルタに必要な属性（title, description, assigneeId, projectId, startDate, dueDate, completed）はすべて既存

---

## 2. 利用する既存API

### 2.1 チケット関連API

| メソッド | パス | 機能 | 利用目的 |
|---------|------|------|----------|
| GET | /api/todos | 全チケット取得 | チケット一覧表示 |
| GET | /api/todos?projectId={id} | 案件別チケット取得 | 案件フィルタ時の初期取得 |
| GET | /api/todos/{id} | チケット詳細取得 | 詳細モーダル表示 |
| PATCH | /api/todos/{id}/toggle | 完了状態切替 | テーブルからの完了操作 |
| DELETE | /api/todos/{id} | チケット削除 | テーブルからの削除操作 |

### 2.2 ユーザー関連API

| メソッド | パス | 機能 | 利用目的 |
|---------|------|------|----------|
| GET | /api/users | 全ユーザー取得 | 担当者フィルタの選択肢表示 |

### 2.3 案件関連API

| メソッド | パス | 機能 | 利用目的 |
|---------|------|------|----------|
| GET | /api/projects | 全案件取得 | 案件フィルタの選択肢表示 |

---

## 3. フィルタ・検索処理の実装方針

### 3.1 処理配置

| 処理 | 実装場所 | 理由 |
|------|---------|------|
| キーワード検索 | フロントエンド | データ量が少なく、全件取得後のフィルタで十分 |
| 完了状態フィルタ | フロントエンド | 同上 |
| 担当者フィルタ | フロントエンド | 同上 |
| 案件フィルタ | フロントエンド | 同上（初期取得時のみAPIパラメータ使用可） |
| 期間フィルタ | フロントエンド | 同上 |
| ソート | フロントエンド | 同上 |

### 3.2 将来的な拡張

データ量が増加した場合（数千件以上）は、以下のバックエンドAPI拡張を検討:

| 機能 | API拡張案 | 備考 |
|------|----------|------|
| キーワード検索 | GET /api/todos?keyword={text} | LIKE検索の実装 |
| 複合フィルタ | GET /api/todos?completed={bool}&assigneeId={id}&... | 複数条件対応 |
| ページネーション | GET /api/todos?page={n}&size={m} | オフセット/リミット |
| ソート | GET /api/todos?sort={field}&order={asc\|desc} | 動的ソート |

これらの拡張は本案件のスコープ外とする。

---

## 4. データ要件

### 4.1 データ構造

| データ名 | 概要 | 変更 |
|---------|------|------|
| Todo | チケットエンティティ | **変更なし** |
| User | ユーザーエンティティ | **変更なし** |
| Project | 案件エンティティ（概念のみ、テーブル未実装） | **変更なし** |

### 4.2 利用するエンティティ属性

#### Todo

| 属性 | 型 | 利用目的 |
|------|-----|---------|
| id | Long | テーブル表示（ID列） |
| title | String | テーブル表示、キーワード検索対象 |
| description | String | テーブル表示、キーワード検索対象 |
| completed | boolean | テーブル表示、完了状態フィルタ |
| startDate | LocalDate | テーブル表示、期間フィルタ |
| dueDate | LocalDate | テーブル表示、期間フィルタ |
| assigneeId | Long | 担当者フィルタ |
| assigneeName | String | テーブル表示（担当者名） |
| projectId | Long | 案件フィルタ |
| createdAt | LocalDateTime | テーブル表示（作成日） |

#### User

| 属性 | 型 | 利用目的 |
|------|-----|---------|
| id | Long | 担当者フィルタの値 |
| name | String | 担当者フィルタの表示名 |

---

## 5. 非機能要件

### 5.1 性能要件

| 項目 | 現状 | 本案件での変更 |
|------|------|---------------|
| API応答時間 | 500ms以内 | **変更なし** |
| 同時アクセス | Spring標準対応 | **変更なし** |

### 5.2 セキュリティ要件

| 項目 | 現状 | 本案件での変更 |
|------|------|---------------|
| 認証 | なし | **変更なし** |
| 入力バリデーション | 既存実装 | **変更なし** |

---

## 6. 制約条件

| 項目 | 制約 |
|------|------|
| データ保存 | H2 Database（変更なし） |
| API変更 | 本案件では追加・変更しない |
| スキーマ変更 | 本案件では追加・変更しない |

---

## 7. 今後の検討事項

本案件では対応しないが、将来的に検討が必要な項目:

| 項目 | 内容 | 優先度 |
|------|------|--------|
| 検索API | キーワード検索をバックエンドで実装 | 中 |
| ページネーション | 大量データ対応 | 中 |
| 複合フィルタAPI | 複数条件を一度に指定 | 低 |

---

## 改版履歴

| 版数 | 日付 | 変更内容 | 変更者 |
|------|------|----------|--------|
| 1.0 | 2025-12-26 | 初版作成（変更なしを明記） | Claude |
