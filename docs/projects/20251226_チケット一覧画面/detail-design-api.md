# API詳細設計書

## 案件情報

| 項目 | 内容 |
|------|------|
| 案件名 | チケット一覧画面 |
| 案件ID | 20251226_チケット一覧画面 |
| 作成日 | 2025-12-26 |
| 関連基本設計書 | [basic-design-backend.md](./basic-design-backend.md) |

---

## 1. 概要

### 1.1 本設計書の目的

REST APIエンドポイントの詳細仕様を定義する。

### 1.2 変更有無

| 項目 | 状態 |
|------|------|
| API追加 | **なし** |
| API変更 | **なし** |
| API削除 | **なし** |

### 1.3 変更なしの理由

本案件はフロントエンドのみの改善であり、以下の理由によりAPIの追加・変更は不要である:

1. **既存APIで対応可能**: `GET /api/todos` で全チケットを取得し、フロントエンドでフィルタ・検索・ソートを実装する
2. **データ量が少ない**: 現時点では数百件程度を想定しており、全件取得後のフロントエンド処理で十分なパフォーマンスが得られる
3. **複合フィルタ不要**: フィルタ処理はフロントエンドのcomputedで実現可能

---

## 2. 利用する既存API

本案件で使用する既存APIの一覧。詳細仕様は [docs/specs/api-catalog.md](../../specs/api-catalog.md) を参照。

### 2.1 チケット関連

| メソッド | パス | 概要 | 利用目的 |
|---------|------|------|----------|
| GET | /api/todos | 全チケット取得 | 一覧表示のデータ取得 |
| GET | /api/todos?projectId={id} | 案件別チケット取得 | projectIdパラメータ付きの場合 |
| GET | /api/todos/{id} | チケット詳細取得 | 詳細モーダル表示 |
| PATCH | /api/todos/{id}/toggle | 完了状態切替 | テーブルからの完了操作 |
| DELETE | /api/todos/{id} | チケット削除 | テーブルからの削除操作 |

### 2.2 ユーザー関連

| メソッド | パス | 概要 | 利用目的 |
|---------|------|------|----------|
| GET | /api/users | 全ユーザー取得 | 担当者フィルタの選択肢 |

### 2.3 案件関連

| メソッド | パス | 概要 | 利用目的 |
|---------|------|------|----------|
| GET | /api/projects | 全案件取得 | 案件フィルタの選択肢 |

---

## 3. フロントエンドでの処理

### 3.1 検索・フィルタ処理

バックエンドAPIに検索・フィルタ機能を追加せず、フロントエンドで実装する。

| 処理 | 実装方法 | 備考 |
|------|---------|------|
| キーワード検索 | computed内でfilter() | title, descriptionを対象 |
| 完了状態フィルタ | computed内でfilter() | completed属性 |
| 担当者フィルタ | computed内でfilter() | assigneeId属性 |
| 案件フィルタ | computed内でfilter() | projectId属性 |
| 期間フィルタ | computed内でfilter() | startDate, dueDate属性 |
| ソート | computed内でsort() | 任意の列で昇順/降順 |

### 3.2 パフォーマンス考慮

| 項目 | 現状 | 対応 |
|------|------|------|
| データ量 | 数百件程度 | 問題なし |
| フィルタ処理 | computed | リアクティブで効率的 |
| 再計算頻度 | 依存データ変更時のみ | Vue3のcomputed最適化 |

---

## 4. 将来的な拡張案

データ量が増加した場合（数千件以上）に検討するAPIの拡張案。

### 4.1 検索API

```
GET /api/todos/search?keyword={text}
```

| パラメータ | 型 | 必須 | 説明 |
|-----------|-----|------|------|
| keyword | String | 任意 | 検索キーワード（title, descriptionをLIKE検索） |

### 4.2 複合フィルタAPI

```
GET /api/todos?completed={bool}&assigneeId={id}&projectId={id}&startDateFrom={date}&dueDateTo={date}
```

### 4.3 ページネーションAPI

```
GET /api/todos?page={n}&size={m}&sort={field}&order={asc|desc}
```

| パラメータ | 型 | 必須 | デフォルト | 説明 |
|-----------|-----|------|-----------|------|
| page | Integer | 任意 | 0 | ページ番号（0始まり） |
| size | Integer | 任意 | 20 | 1ページあたりの件数 |
| sort | String | 任意 | createdAt | ソートキー |
| order | String | 任意 | desc | ソート順序 |

**注意**: これらの拡張は本案件のスコープ外であり、将来的な検討事項として記載。

---

## 5. Controllerクラス設計

### 5.1 変更なし

本案件ではControllerクラスの変更は不要。

| クラス | 変更 |
|--------|------|
| TodoController | **変更なし** |
| UserController | **変更なし** |
| ProjectController | **変更なし** |

---

## 改版履歴

| 版数 | 日付 | 変更内容 | 変更者 |
|------|------|----------|--------|
| 1.0 | 2025-12-26 | 初版作成（変更なしを明記） | Claude |
