# フロントエンド基本設計書

## 案件情報

| 項目 | 内容 |
|------|------|
| 案件名 | チケット一覧画面 |
| 案件ID | 20251226_チケット一覧画面 |
| 作成日 | 2025-12-26 |
| 関連要件整理書 | [requirements.md](./requirements.md) |

---

## 1. 概要

### 1.1 本設計書の目的

チケット一覧画面（SC-005）のフロントエンド基本設計を定義する。

### 1.2 フロントエンドの役割

| 責務 | 説明 |
|------|------|
| 画面表示 | チケットをテーブル形式で一覧表示 |
| ユーザー操作 | 検索・フィルタ・ソート操作の受付 |
| API連携 | 既存のtodoStore経由でバックエンドAPIと通信 |
| 状態管理 | 検索条件・フィルタ条件・ソート状態の管理 |

---

## 2. 技術要件

### 2.1 使用技術

| 項目 | 技術 |
|------|------|
| フレームワーク | Vue.js 3 (Composition API) |
| 言語 | TypeScript |
| 状態管理 | Pinia（既存のtodoStore, userStore, projectStoreを活用） |
| ルーティング | Vue Router 4 |
| ビルドツール | Vite |
| API通信 | 既存のapiClientを利用 |
| スタイル | CSS3 (Scoped Styles) |

### 2.2 コンポーネント構成（Vue.js）

| 項目 | 方針 |
|------|------|
| コンポーネント分割 | 画面・機能単位でフォルダを分割（既存構成に準拠） |
| 命名規則 | PascalCase（例: TodoTableView.vue, TodoSearchForm.vue） |
| スタイル | Scoped CSS を使用 |
| 型定義 | すべてのコンポーネントにTypeScript型定義 |
| Props/Emits | 型安全な defineProps / defineEmits を使用 |

### 2.3 状態管理方針（Pinia）

| 項目 | 方針 |
|------|------|
| ストア設計 | 既存のtodoStoreを活用。検索・フィルタ状態は画面ローカルで管理 |
| API呼び出し | 既存のtodoStore.fetchTodos()を使用 |
| フィルタ処理 | フロントエンドでcomputed実装（全件取得後にフィルタ） |
| ソート処理 | フロントエンドでcomputed実装 |

---

## 3. 画面要件

### 3.1 画面・コンポーネント一覧

| ID | 種別 | 名称 | パス/配置 | 概要 | 対応US |
|----|------|------|----------|------|--------|
| SC-005 | 画面 | チケット一覧画面 | `/todos/table` | テーブル形式でチケットを一覧表示 | US-001 |
| CP-001 | コンポーネント | TodoSearchForm | components/todo/ | 検索フォーム | US-002 |
| CP-002 | コンポーネント | TodoTableFilter | components/todo/ | フィルタセレクト群 | US-003 |
| CP-003 | コンポーネント | TodoTable | components/todo/ | チケットテーブル | US-001, US-004 |
| CP-004 | コンポーネント | TodoTableRow | components/todo/ | テーブル行 | - |

### 3.2 画面遷移

```
┌─────────────┐          ┌─────────────────────┐
│  ホーム画面  │ ──────→ │  チケット一覧画面    │
│   (/)       │          │  (/todos/table)     │
└─────────────┘          └─────────────────────┘
      │                           │
      ▼                           ▼
┌─────────────────┐       ┌─────────────────────┐
│ プロジェクト画面 │ ────→ │  チケット一覧画面    │
│  (/projects)    │       │ (/todos/table?      │
└─────────────────┘       │   projectId=X)      │
                          └─────────────────────┘

※ 既存のカード形式画面（/todos）は維持
```

### 3.3 画面遷移フロー

| 起点画面 | 操作 | 遷移先 | 備考 |
|---------|------|--------|------|
| ホーム | 「チケット一覧（テーブル）」クリック | チケット一覧画面 | 全チケット表示 |
| プロジェクト | 「一覧表示」ボタン | チケット一覧画面 | projectId付きクエリパラメータ |
| チケット一覧 | 「カード表示に切替」リンク | 既存ToDoリスト画面 | クエリパラメータ維持 |
| チケット一覧 | 行クリック | 詳細モーダル表示 | 同一画面内 |

---

## 4. 画面・コンポーネント詳細

### 4.1 SC-005: チケット一覧画面

| 項目 | 内容 |
|------|------|
| 種別 | 画面（View） |
| ファイル | `src/frontend/src/views/TodoTableView.vue` |
| パス | `/todos/table` または `/todos/table?projectId={id}` |
| 目的 | チケットをテーブル形式で一覧表示し、検索・フィルタ・ソートを提供 |

#### レイアウト

```
┌─────────────────────────────────────────────────────────────┐
│                    チケット一覧                              │  ← ヘッダー
├─────────────────────────────────────────────────────────────┤
│  [検索キーワード入力                                    ]   │  ← 検索フォーム
├─────────────────────────────────────────────────────────────┤
│  状態: [すべて▼]  担当者: [すべて▼]  案件: [すべて▼]        │  ← フィルタ
│  期間: [開始日] ～ [終了日]                                  │
├─────────────────────────────────────────────────────────────┤
│  表示件数: XX件                                              │  ← 統計
├─────────────────────────────────────────────────────────────┤
│  | ID▲ | タイトル | 説明 | 担当者 | 案件 | 開始 | 終了 | 状態 |  ← テーブルヘッダー
│  |-----|---------|------|--------|------|------|------|------|
│  |  1  | タスク1  | ...  | 山田   | PJ-A | 12/1 | 12/5 | 未完 |  ← データ行
│  |  2  | タスク2  | ...  | 鈴木   | PJ-B | 12/3 | 12/8 | 完了 |
│  | ... | ...     | ...  | ...    | ...  | ...  | ...  | ...  |
├─────────────────────────────────────────────────────────────┤
│        ← ホームに戻る    カード表示に切替 →                  │  ← フッター
└─────────────────────────────────────────────────────────────┘
```

#### 構成要素

| 要素 | 種別 | 説明 | 機能 |
|------|------|------|------|
| ヘッダー | テキスト | 画面タイトル | - |
| 検索フォーム | コンポーネント | TodoSearchForm.vue | キーワード検索 |
| フィルタ | コンポーネント | TodoTableFilter.vue | 属性フィルタ |
| 統計表示 | テキスト | 表示件数を表示 | - |
| テーブル | コンポーネント | TodoTable.vue | チケット一覧表示 |
| フッター | リンク群 | ナビゲーションリンク | 画面遷移 |

---

### 4.2 CP-001: TodoSearchForm

| 項目 | 内容 |
|------|------|
| 種別 | コンポーネント |
| ファイル | `src/frontend/src/components/todo/TodoSearchForm.vue` |
| 目的 | キーワード検索の入力を受け付ける |

#### レイアウト

```
┌─────────────────────────────────────────────────────────────┐
│  [🔍 検索キーワードを入力...                            ]   │
└─────────────────────────────────────────────────────────────┘
```

#### Props / Emits

**Props**:

| Prop名 | 型 | 必須 | 説明 |
|--------|-----|------|------|
| modelValue | string | - | 検索キーワード（v-model） |

**Emits**:

| イベント名 | ペイロード型 | 説明 |
|-----------|------------|------|
| update:modelValue | string | 検索キーワード変更時 |

---

### 4.3 CP-002: TodoTableFilter

| 項目 | 内容 |
|------|------|
| 種別 | コンポーネント |
| ファイル | `src/frontend/src/components/todo/TodoTableFilter.vue` |
| 目的 | 各種フィルタ条件の選択を受け付ける |

#### レイアウト

```
┌─────────────────────────────────────────────────────────────┐
│  状態: [すべて▼]  担当者: [すべて▼]  案件: [すべて▼]        │
│  期間: [    開始日    ] ～ [    終了日    ]                  │
└─────────────────────────────────────────────────────────────┘
```

#### Props / Emits

**Props**:

| Prop名 | 型 | 必須 | 説明 |
|--------|-----|------|------|
| filter | FilterState | ✓ | フィルタ状態オブジェクト |
| users | User[] | ✓ | 担当者選択肢 |
| projects | Project[] | ✓ | 案件選択肢 |

**Emits**:

| イベント名 | ペイロード型 | 説明 |
|-----------|------------|------|
| update:filter | FilterState | フィルタ条件変更時 |

**FilterState型**:

```typescript
interface FilterState {
  completed: 'all' | 'pending' | 'completed'
  assigneeId: number | null
  projectId: number | null
  startDateFrom: string | null  // YYYY-MM-DD
  startDateTo: string | null    // YYYY-MM-DD
  dueDateFrom: string | null    // YYYY-MM-DD
  dueDateTo: string | null      // YYYY-MM-DD
}
```

---

### 4.4 CP-003: TodoTable

| 項目 | 内容 |
|------|------|
| 種別 | コンポーネント |
| ファイル | `src/frontend/src/components/todo/TodoTable.vue` |
| 目的 | チケットをテーブル形式で表示し、ソート機能を提供 |

#### レイアウト

```
┌─────────────────────────────────────────────────────────────┐
│  | ID▲ | タイトル | 説明 | 担当者 | 案件 | 開始 | 終了 | 状態 |
│  |-----|---------|------|--------|------|------|------|------|
│  | TodoTableRow × n                                         |
└─────────────────────────────────────────────────────────────┘
```

#### Props / Emits

**Props**:

| Prop名 | 型 | 必須 | 説明 |
|--------|-----|------|------|
| todos | Todo[] | ✓ | 表示するチケット配列 |
| sortKey | string | - | 現在のソートキー |
| sortOrder | 'asc' \| 'desc' | - | ソート順序 |

**Emits**:

| イベント名 | ペイロード型 | 説明 |
|-----------|------------|------|
| sort | { key: string, order: 'asc' \| 'desc' } | ソート変更時 |
| rowClick | number | 行クリック時（todoId） |

#### テーブル列定義

| # | 列名 | フィールド | 幅 | ソート | 表示形式 |
|---|------|-----------|-----|------|---------|
| 1 | ID | id | 60px | 可 | 右寄せ、数値 |
| 2 | タイトル | title | flex | 可 | 左寄せ、省略なし |
| 3 | 説明 | description | 200px | 不可 | 左寄せ、30文字で省略 |
| 4 | 担当者 | assigneeName | 100px | 可 | 未割当時は「-」 |
| 5 | 案件 | projectName | 120px | 可 | 未分類時は「-」 |
| 6 | 開始日 | startDate | 100px | 可 | YYYY/MM/DD |
| 7 | 終了日 | dueDate | 100px | 可 | YYYY/MM/DD |
| 8 | 状態 | completed | 80px | 可 | 完了/未完了バッジ |
| 9 | 作成日 | createdAt | 100px | 可 | YYYY/MM/DD |

---

### 4.5 CP-004: TodoTableRow

| 項目 | 内容 |
|------|------|
| 種別 | コンポーネント |
| ファイル | `src/frontend/src/components/todo/TodoTableRow.vue` |
| 目的 | テーブルの1行を表示 |

#### Props / Emits

**Props**:

| Prop名 | 型 | 必須 | 説明 |
|--------|-----|------|------|
| todo | Todo | ✓ | 表示するチケット |
| projectName | string | - | 案件名 |

**Emits**:

| イベント名 | ペイロード型 | 説明 |
|-----------|------------|------|
| click | - | 行クリック時 |

---

## 5. 共通UI要件

### 5.1 共通コンポーネント

| コンポーネント | 用途 |
|--------------|------|
| LoadingSpinner | ローディング表示（既存） |
| ErrorMessage | エラーメッセージ表示（既存） |
| TodoDetailModal | チケット詳細モーダル（既存） |

### 5.2 UI状態

| 状態 | 表示 |
|------|------|
| ローディング中 | LoadingSpinnerを表示 |
| エラー発生時 | ErrorMessageを表示 |
| データなし | 「該当するチケットがありません」メッセージ |
| 検索結果なし | 「検索条件に一致するチケットがありません」メッセージ |

---

## 6. 非機能要件

### 6.1 ユーザビリティ

| 項目 | 要件 |
|------|------|
| 応答性 | 検索・フィルタ・ソート操作は即座に反映（100ms以内） |
| フィードバック | ソート中の列ヘッダーにアイコン表示（▲/▼） |
| ホバー | 行ホバー時に背景色変更 |

### 6.2 アクセシビリティ

| 項目 | 対応 |
|------|------|
| キーボード操作 | Tab移動、Enterで行選択 |
| フォーカス表示 | フォーカス中の行をハイライト |

---

## 7. 制約条件

| 項目 | 制約 |
|------|------|
| 対応ブラウザ | Chrome/Firefox/Edge 最新版 |
| レスポンシブ | デスクトップ最適化（1024px以上） |
| 外部ライブラリ | 追加なし（既存技術スタックのみ） |

---

## 改版履歴

| 版数 | 日付 | 変更内容 | 変更者 |
|------|------|----------|--------|
| 1.0 | 2025-12-26 | 初版作成 | Claude |
