import{q as s}from"./index-D1rnpmQv.js";import{d as n,p as i,a as l,g as c}from"./apiClient-DXSJKec5.js";async function a(t){let o="/todos";return t&&(o+=`?projectId=${encodeURIComponent(t)}`),c(o)}async function d(t){return l("/todos",t)}async function h(t){return i(`/todos/${t}/toggle`)}async function u(t){return n(`/todos/${t}`)}const p=s("todo",{state:()=>({todos:[],loading:!1,error:null,filter:"all",currentProjectId:null}),getters:{filteredTodos:t=>{switch(t.filter){case"pending":return t.todos.filter(o=>!o.completed);case"completed":return t.todos.filter(o=>o.completed);default:return t.todos}},stats:t=>{const o=t.todos.length,e=t.todos.filter(r=>r.completed).length;return{total:o,completed:e,pending:o-e}}},actions:{async fetchTodos(t){this.loading=!0,this.error=null,this.currentProjectId=t??null;try{this.todos=await a(t)}catch(o){throw this.error="ToDoリストの読み込みに失敗しました",o}finally{this.loading=!1}},async addTodo(t){this.error=null;try{await d(t),await this.fetchTodos(this.currentProjectId)}catch(o){throw this.error="ToDoの追加に失敗しました",o}},async toggleTodo(t){this.error=null;try{await h(t),await this.fetchTodos(this.currentProjectId)}catch(o){throw this.error="ToDoの更新に失敗しました",o}},async deleteTodo(t){this.error=null;try{await u(t),await this.fetchTodos(this.currentProjectId)}catch(o){throw this.error="ToDoの削除に失敗しました",o}},setFilter(t){this.filter=t},clearError(){this.error=null}}});export{p as u};
