import{d as F,s as w,z as E,b as i,a as e,g as K,l as I,v as U,o as n,_ as x,F as j,j as S,y as D,t as g,k as $,n as O,C as z,p as V,c as A,u as Y,B as q,e as G}from"./index-D1rnpmQv.js";import{u as H}from"./todoStore-CnlSoGBi.js";import{u as J}from"./userStore-0NiYegvr.js";import{u as Q}from"./projectStore-B_amqasO.js";import"./apiClient-DXSJKec5.js";import"./projectService--dyVZNgQ.js";const L={completed:"all",assigneeId:null,projectId:null,startDateFrom:null,startDateTo:null,dueDateFrom:null,dueDateTo:null},W=[{key:"id",label:"ID",width:"60px",sortable:!0},{key:"title",label:"ã‚¿ã‚¤ãƒˆãƒ«",width:"auto",sortable:!0},{key:"description",label:"èª¬æ˜",width:"200px",sortable:!1},{key:"assigneeName",label:"æ‹…å½“è€…",width:"100px",sortable:!0},{key:"projectId",label:"æ¡ˆä»¶",width:"120px",sortable:!0},{key:"startDate",label:"é–‹å§‹æ—¥",width:"100px",sortable:!0},{key:"dueDate",label:"çµ‚äº†æ—¥",width:"100px",sortable:!0},{key:"completed",label:"çŠ¶æ…‹",width:"80px",sortable:!0},{key:"createdAt",label:"ä½œæˆæ—¥",width:"100px",sortable:!0}],X=[{value:"all",label:"ã™ã¹ã¦"},{value:"pending",label:"æœªå®Œäº†"},{value:"completed",label:"å®Œäº†æ¸ˆã¿"}],Z={class:"todo-search-form"},ee={class:"search-input-wrapper"},te=F({__name:"TodoSearchForm",props:{keyword:{}},emits:["search"],setup(s,{emit:y}){const r=s,b=y,c=w(r.keyword);E(()=>r.keyword,f=>{c.value=f});function m(){b("search",c.value)}function a(){c.value="",b("search","")}return(f,u)=>(n(),i("div",Z,[e("div",ee,[u[1]||(u[1]=e("span",{class:"search-icon"},"ğŸ”",-1)),K(e("input",{"onUpdate:modelValue":u[0]||(u[0]=d=>c.value=d),type:"text",class:"search-input",placeholder:"ã‚¿ã‚¤ãƒˆãƒ«ãƒ»èª¬æ˜ã§æ¤œç´¢...",onInput:m},null,544),[[U,c.value]]),c.value?(n(),i("button",{key:0,class:"clear-btn",onClick:a,title:"ã‚¯ãƒªã‚¢"}," Ã— ")):I("",!0)])]))}}),oe=x(te,[["__scopeId","data-v-77dd552a"]]),le={class:"todo-table-filter"},ae={class:"filter-row"},se={class:"filter-group"},ne=["value"],re=["value"],de={class:"filter-group"},ie=["value"],ce=["value"],ue={class:"filter-group"},ve=["value"],fe=["value"],pe={class:"filter-row"},he={class:"filter-group date-range"},ge={class:"date-inputs"},me=["value"],be=["value"],_e={class:"filter-group date-range"},ye={class:"date-inputs"},De=["value"],ke=["value"],Te=F({__name:"TodoTableFilter",props:{filter:{},users:{},projects:{}},emits:["update:filter","reset"],setup(s,{emit:y}){const r=s,b=y;function c(v){b("update:filter",{...r.filter,...v})}function m(v){const t=v.target.value;c({completed:t})}function a(v){const t=v.target.value;c({assigneeId:t?Number(t):null})}function f(v){const t=v.target.value;c({projectId:t?Number(t):null})}function u(v){const t=v.target.value;c({startDateFrom:t||null})}function d(v){const t=v.target.value;c({startDateTo:t||null})}function p(v){const t=v.target.value;c({dueDateFrom:t||null})}function h(v){const t=v.target.value;c({dueDateTo:t||null})}function k(){b("reset")}return(v,t)=>(n(),i("div",le,[e("div",ae,[e("div",se,[t[0]||(t[0]=e("label",{class:"filter-label"},"çŠ¶æ…‹",-1)),e("select",{class:"filter-select",value:s.filter.completed,onChange:m},[(n(!0),i(j,null,S(D(X),_=>(n(),i("option",{key:_.value,value:_.value},g(_.label),9,re))),128))],40,ne)]),e("div",de,[t[2]||(t[2]=e("label",{class:"filter-label"},"æ‹…å½“è€…",-1)),e("select",{class:"filter-select",value:s.filter.assigneeId??"",onChange:a},[t[1]||(t[1]=e("option",{value:""},"ã™ã¹ã¦",-1)),(n(!0),i(j,null,S(s.users,_=>(n(),i("option",{key:_.id,value:_.id},g(_.name),9,ce))),128))],40,ie)]),e("div",ue,[t[4]||(t[4]=e("label",{class:"filter-label"},"æ¡ˆä»¶",-1)),e("select",{class:"filter-select",value:s.filter.projectId??"",onChange:f},[t[3]||(t[3]=e("option",{value:""},"ã™ã¹ã¦",-1)),(n(!0),i(j,null,S(s.projects,_=>(n(),i("option",{key:_.id,value:_.id},g(_.name),9,fe))),128))],40,ve)])]),e("div",pe,[e("div",he,[t[6]||(t[6]=e("label",{class:"filter-label"},"é–‹å§‹æ—¥",-1)),e("div",ge,[e("input",{type:"date",class:"filter-input",value:s.filter.startDateFrom??"",onChange:u},null,40,me),t[5]||(t[5]=e("span",{class:"date-separator"},"ã€œ",-1)),e("input",{type:"date",class:"filter-input",value:s.filter.startDateTo??"",onChange:d},null,40,be)])]),e("div",_e,[t[8]||(t[8]=e("label",{class:"filter-label"},"çµ‚äº†æ—¥",-1)),e("div",ye,[e("input",{type:"date",class:"filter-input",value:s.filter.dueDateFrom??"",onChange:p},null,40,De),t[7]||(t[7]=e("span",{class:"date-separator"},"ã€œ",-1)),e("input",{type:"date",class:"filter-input",value:s.filter.dueDateTo??"",onChange:h},null,40,ke)])]),e("div",{class:"filter-actions"},[e("button",{class:"reset-btn",onClick:k},"ãƒªã‚»ãƒƒãƒˆ")])])]))}}),we=x(Te,[["__scopeId","data-v-da3f90ee"]]),$e={class:"col-checkbox"},Ce=["checked"],Ie={class:"col-id"},je={class:"col-title"},Se={class:"title-text"},Fe=["title"],xe={class:"col-assigneeName"},Ne={class:"col-projectId"},Oe={class:"col-startDate"},Ve={class:"col-dueDate"},Ae={class:"col-completed"},Le={class:"col-createdAt"},Re=F({__name:"TodoTableRow",props:{todo:{},projects:{}},emits:["toggle","delete"],setup(s,{emit:y}){const r=s,b=y,c=$(()=>{if(r.todo.projectId===null)return"-";const p=r.projects.find(h=>h.id===r.todo.projectId);return(p==null?void 0:p.name)??"-"}),m=$(()=>{const p=r.todo.description;return p?p.length<=30?p:p.substring(0,30)+"...":"-"});function a(p){if(!p)return"-";const h=new Date(p),k=h.getFullYear(),v=String(h.getMonth()+1).padStart(2,"0"),t=String(h.getDate()).padStart(2,"0");return`${k}/${v}/${t}`}function f(p){const h=new Date(p),k=h.getFullYear(),v=String(h.getMonth()+1).padStart(2,"0"),t=String(h.getDate()).padStart(2,"0");return`${k}/${v}/${t}`}function u(){b("toggle",r.todo.id)}function d(){b("delete",r.todo.id)}return(p,h)=>(n(),i("tr",{class:O({completed:s.todo.completed})},[e("td",$e,[e("input",{type:"checkbox",checked:s.todo.completed,onChange:u,title:"å®Œäº†çŠ¶æ…‹ã‚’åˆ‡ã‚Šæ›¿ãˆ"},null,40,Ce)]),e("td",Ie,g(s.todo.id),1),e("td",je,[e("span",Se,g(s.todo.title),1)]),e("td",{class:"col-description",title:s.todo.description??""},g(m.value),9,Fe),e("td",xe,g(s.todo.assigneeName??"-"),1),e("td",Ne,g(c.value),1),e("td",Oe,g(a(s.todo.startDate)),1),e("td",Ve,g(a(s.todo.dueDate)),1),e("td",Ae,[e("span",{class:O(["status-badge",s.todo.completed?"done":"pending"])},g(s.todo.completed?"å®Œäº†":"æœªå®Œäº†"),3)]),e("td",Le,g(f(s.todo.createdAt)),1),e("td",{class:"col-actions"},[e("button",{class:"delete-btn",onClick:d,title:"å‰Šé™¤"}," ğŸ—‘ ")])],2))}}),Be=x(Re,[["__scopeId","data-v-a24608f4"]]),Me={class:"todo-table-wrapper"},Pe={class:"todo-table"},Ee=["onClick"],Ke={key:0,class:"sort-indicator"},Ue=F({__name:"TodoTable",props:{todos:{},projects:{},sortKey:{},sortOrder:{}},emits:["sort","toggle","delete"],setup(s,{emit:y}){const r=y;function b(f){r("sort",f)}function c(f){r("toggle",f)}function m(f){r("delete",f)}function a(f,u,d){return f!==u?"":d==="asc"?" â–²":" â–¼"}return(f,u)=>(n(),i("div",Me,[e("table",Pe,[e("thead",null,[e("tr",null,[u[0]||(u[0]=e("th",{class:"col-checkbox"},null,-1)),(n(!0),i(j,null,S(D(W),d=>(n(),i("th",{key:d.key,class:O(["col-"+d.key,{sortable:d.sortable}]),style:z({width:d.width}),onClick:p=>d.sortable?b(d.key):void 0},[V(g(d.label)+" ",1),d.sortable?(n(),i("span",Ke,g(a(d.key,s.sortKey,s.sortOrder)),1)):I("",!0)],14,Ee))),128)),u[1]||(u[1]=e("th",{class:"col-actions"},"æ“ä½œ",-1))])]),e("tbody",null,[(n(!0),i(j,null,S(s.todos,d=>(n(),A(Be,{key:d.id,todo:d,projects:s.projects,onToggle:c,onDelete:m},null,8,["todo","projects"]))),128))])])]))}}),ze=x(Ue,[["__scopeId","data-v-670da2b5"]]),Ye={class:"todo-table-view"},qe={class:"view-header"},Ge={class:"header-info"},He={class:"count-info"},Je={key:0,class:"filter-badge"},Qe={class:"toolbar"},We={key:0,class:"active-indicator"},Xe={key:1,class:"loading"},Ze={key:2,class:"error"},et={key:3,class:"empty"},tt={key:0},ot={key:1},lt=F({__name:"TodoTableView",setup(s){const y=q(),r=H(),b=J(),c=Q(),m=w(""),a=w({...L}),f=w("id"),u=w("asc"),d=w(!1),p=$(()=>{let l=[...r.todos];if(m.value){const o=m.value.toLowerCase();l=l.filter(C=>{var T;return C.title.toLowerCase().includes(o)||(((T=C.description)==null?void 0:T.toLowerCase().includes(o))??!1)})}return a.value.completed==="pending"?l=l.filter(o=>!o.completed):a.value.completed==="completed"&&(l=l.filter(o=>o.completed)),a.value.assigneeId!==null&&(l=l.filter(o=>o.assigneeId===a.value.assigneeId)),a.value.projectId!==null&&(l=l.filter(o=>o.projectId===a.value.projectId)),a.value.startDateFrom&&(l=l.filter(o=>o.startDate&&o.startDate>=a.value.startDateFrom)),a.value.startDateTo&&(l=l.filter(o=>o.startDate&&o.startDate<=a.value.startDateTo)),a.value.dueDateFrom&&(l=l.filter(o=>o.dueDate&&o.dueDate>=a.value.dueDateFrom)),a.value.dueDateTo&&(l=l.filter(o=>o.dueDate&&o.dueDate<=a.value.dueDateTo)),l.sort((o,C)=>{const T=o[f.value],N=C[f.value];return T==null?1:N==null?-1:T<N?u.value==="asc"?-1:1:T>N?u.value==="asc"?1:-1:0}),l}),h=$(()=>a.value.completed!=="all"||a.value.assigneeId!==null||a.value.projectId!==null||a.value.startDateFrom!==null||a.value.startDateTo!==null||a.value.dueDateFrom!==null||a.value.dueDateTo!==null),k=$(()=>p.value.length),v=$(()=>r.todos.length);function t(l){m.value=l}function _(l){a.value={...l}}function R(){a.value={...L}}function B(l){f.value===l?u.value=u.value==="asc"?"desc":"asc":(f.value=l,u.value="asc")}async function M(l){try{await r.toggleTodo(l)}catch(o){console.error("å®Œäº†çŠ¶æ…‹ã®æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸ:",o)}}async function P(l){if(confirm("ã“ã®ãƒã‚±ãƒƒãƒˆã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ"))try{await r.deleteTodo(l)}catch(o){console.error("ãƒã‚±ãƒƒãƒˆã®å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ:",o)}}return Y(async()=>{await Promise.all([b.fetchUsers(),c.fetchProjects()]);const l=y.query.projectId;l?(a.value.projectId=Number(l),await r.fetchTodos(String(l))):await r.fetchTodos()}),(l,o)=>(n(),i("div",Ye,[e("header",qe,[o[1]||(o[1]=e("h1",null,"ãƒã‚±ãƒƒãƒˆä¸€è¦§",-1)),e("div",Ge,[e("span",He,[V(g(k.value)+" / "+g(v.value)+" ä»¶ ",1),h.value||m.value?(n(),i("span",Je,"ãƒ•ã‚£ãƒ«ã‚¿ä¸­")):I("",!0)])])]),e("div",Qe,[G(oe,{keyword:m.value,onSearch:t},null,8,["keyword"]),e("button",{class:O(["filter-toggle-btn",{active:d.value||h.value}]),onClick:o[0]||(o[0]=C=>d.value=!d.value)},[o[2]||(o[2]=e("span",{class:"icon"},"ğŸ”",-1)),o[3]||(o[3]=V(" ãƒ•ã‚£ãƒ«ã‚¿ ",-1)),h.value?(n(),i("span",We)):I("",!0)],2)]),d.value?(n(),A(we,{key:0,filter:a.value,users:D(b).users,projects:D(c).projects,"onUpdate:filter":_,onReset:R},null,8,["filter","users","projects"])):I("",!0),D(r).loading?(n(),i("div",Xe,"èª­ã¿è¾¼ã¿ä¸­...")):D(r).error?(n(),i("div",Ze,g(D(r).error),1)):p.value.length===0?(n(),i("div",et,[m.value||h.value?(n(),i("p",tt,"æ¡ä»¶ã«ä¸€è‡´ã™ã‚‹ãƒã‚±ãƒƒãƒˆãŒã‚ã‚Šã¾ã›ã‚“")):(n(),i("p",ot,"ãƒã‚±ãƒƒãƒˆãŒã‚ã‚Šã¾ã›ã‚“"))])):(n(),A(ze,{key:4,todos:p.value,projects:D(c).projects,"sort-key":f.value,"sort-order":u.value,onSort:B,onToggle:M,onDelete:P},null,8,["todos","projects","sort-key","sort-order"]))]))}}),ct=x(lt,[["__scopeId","data-v-187ee59f"]]);export{ct as default};
