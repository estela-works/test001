import{d as b,f as D,b as i,a as n,g as S,v as _,h as B,o,_ as w,n as F,l as g,t as j,C as I,k as v,u as R,e as f,c as C,F as T,j as E,p as k,w as V,r as L,D as M}from"./index-D1rnpmQv.js";import{u as z}from"./projectStore-B_amqasO.js";import{E as K,L as U}from"./ErrorMessage-B4CrD3zU.js";import"./projectService--dyVZNgQ.js";import"./apiClient-DXSJKec5.js";const q={class:"add-form card"},A=b({__name:"ProjectForm",emits:["submit"],setup(t,{emit:d}){const s=d,e=D({name:"",description:""}),m=()=>{e.name="",e.description=""},c=()=>{if(!e.name.trim()){alert("案件名を入力してください");return}s("submit",{name:e.name.trim(),description:e.description.trim()||void 0}),m()};return(u,a)=>(o(),i("div",q,[a[2]||(a[2]=n("h3",null,"新しい案件を作成",-1)),S(n("input",{"onUpdate:modelValue":a[0]||(a[0]=p=>e.name=p),type:"text",placeholder:"案件名を入力してください",onKeypress:B(c,["enter"])},null,544),[[_,e.name]]),S(n("textarea",{"onUpdate:modelValue":a[1]||(a[1]=p=>e.description=p),rows:"2",placeholder:"説明を入力してください（オプション）"},null,512),[[_,e.description]]),n("button",{class:"btn-primary",onClick:c},"作成")]))}}),G=w(A,[["__scopeId","data-v-02cf772a"]]),H={key:0},J={class:"stats-info"},O={key:1,class:"progress-bar"},Q={class:"actions"},W=b({__name:"ProjectCard",props:{project:{},stats:{},isNoProject:{type:Boolean}},emits:["view","delete"],setup(t,{emit:d}){const s=t,e=d,m=()=>{confirm("この案件を削除しますか？紐づいたチケットは未分類になります。")&&e("delete",s.project.id)};return(c,u)=>(o(),i("div",{class:F(["project-card card",{"no-project":t.isNoProject}])},[n("h3",null,j(t.project.name),1),t.project.description?(o(),i("p",H,j(t.project.description),1)):g("",!0),n("p",J," チケット: "+j(t.stats.total)+"件 / 完了: "+j(t.stats.completed)+"件 / 進捗: "+j(t.stats.progressRate)+"% ",1),t.isNoProject?g("",!0):(o(),i("div",O,[n("div",{class:"progress",style:I({width:t.stats.progressRate+"%"})},null,4)])),n("div",Q,[n("button",{class:"view-btn btn-primary",onClick:u[0]||(u[0]=a=>c.$emit("view",t.project.id))},"チケット一覧"),t.isNoProject?g("",!0):(o(),i("button",{key:0,class:"delete-btn btn-danger",onClick:m},"削除"))])],2))}}),$=w(W,[["__scopeId","data-v-0efb1fc9"]]),X={class:"container"},Y={key:1},Z={key:0,class:"empty-message"},tt={class:"back-link"},et=b({__name:"ProjectView",setup(t){const d=M(),s=z(),e=v(()=>s.projects),m=v(()=>s.projectStats),c=v(()=>s.noProjectStats),u=v(()=>s.loading),a=v(()=>s.error),p={total:0,completed:0,progressRate:0},x=async l=>{try{await s.createProject(l)}catch{}},N=async l=>{try{await s.deleteProject(l)}catch{}},P=l=>{d.push({path:"/todos",query:{projectId:String(l)}})};return R(async()=>{await s.fetchProjects()}),(l,r)=>{const h=L("router-link");return o(),i("div",X,[r[4]||(r[4]=n("h1",null,"案件一覧",-1)),f(G,{onSubmit:x}),f(K,{message:a.value},null,8,["message"]),u.value?(o(),C(U,{key:0})):(o(),i("div",Y,[e.value.length===0?(o(),i("p",Z,"案件がありません。")):g("",!0),(o(!0),i(T,null,E(e.value,y=>(o(),C($,{key:y.id,project:y,stats:m.value[y.id]||p,onView:P,onDelete:N},null,8,["project","stats"]))),128)),f($,{project:{id:"none",name:"案件なし（未分類）",description:"案件に紐づかないチケット",createdAt:""},stats:c.value,"is-no-project":!0,onView:r[0]||(r[0]=y=>P("none"))},null,8,["stats"])])),n("div",tt,[f(h,{to:"/users"},{default:V(()=>[...r[1]||(r[1]=[k("ユーザー管理",-1)])]),_:1}),r[3]||(r[3]=k(" | ",-1)),f(h,{to:"/"},{default:V(()=>[...r[2]||(r[2]=[k("← ホームに戻る",-1)])]),_:1})])])}}}),it=w(et,[["__scopeId","data-v-ca7ef0fc"]]);export{it as default};
